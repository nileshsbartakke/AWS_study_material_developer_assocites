function SlideManager(oLightningDetails,oEventDetails){var m_oParentContainer,m_oIFrame,m_oLocalContent,m_oCurrentSlide,m_oCurrentContentObject,m_oCurrentContentElem,m_oGetSlideInfoAJAX,FLAG_LOOP_VIDEO=2,FLAG_HTML_REDIRECT=8,FLAG_CHAPTER=128,CONTENT_TYPE_RENDER_URL=-1,_this=this,m_oLightningDetails=oLightningDetails,m_oEventDetails=oEventDetails,m_oSlideDataMap={},m_iCurrentStep=0,m_iTotalSteps=0,m_bEnableRendering=!1;function RenderSlide(iSlideContentKey,bForceRendering,bClearCache){if(!bClearCache&&m_oCurrentSlide&&iSlideContentKey==m_oCurrentSlide.SlideContentKey&&!bForceRendering)return!1;var oData=m_oSlideDataMap[iSlideContentKey];if(!bClearCache&&m_oCurrentSlide&&-1==iSlideContentKey&&oData.ContentHTML==m_oCurrentSlide.ContentHTML&&!bForceRendering)return!1;if(oData.Chapter=(oData.SlideFlags&FLAG_CHAPTER)==FLAG_CHAPTER,!m_bEnableRendering)return!0;m_oGetSlideInfoAJAX.Abort();var bValid=_this.ApproveSlide(oData);if(bValid)switch(m_oCurrentSlide=oData,oData.ContentType){case CONTENT_TYPE_RENDER_URL:IFrameLoad(oData.ContentHTML);break;case 11:if((oData.SlideFlags&FLAG_HTML_REDIRECT)==FLAG_HTML_REDIRECT){!function(iSlideContentKey,bClearCache){m_oGetSlideInfoAJAX.Abort(),m_oGetSlideInfoAJAX.OnComplete=function(cResult){var oJSON=InxpoAJAXEvalJSON(cResult);if(oJSON.SlideContentKey==iSlideContentKey){m_oSlideDataMap[iSlideContentKey]=oJSON;var cURL=oJSON.ContentHTML,iSlideNumber=-1,acSplits=cURL.split("?");2==acSplits.length&&m_oIFrame.src.indexOf(acSplits[0])>-1&&(cURL=null,iSlideNumber=parseInt(acSplits[1].replace("slideNumber=","")),!bClearCache&&iSlideNumber>-1||(cURL=oJSON.ContentHTML+(bClearCache?"&StudioClear=1":""))),cURL?IFrameLoad(cURL):iSlideNumber>-1&&function(iSlideNumber){ToggleIFrame(!0),ToggleLocalContent(!1),CleanUpSlideArea(),m_oIFrame&&(m_oCurrentContentObject=m_oCurrentContentElem=m_oIFrame,m_oIFrame.contentWindow.postMessage({Type:"JumpToSlide",SlideNumber:iSlideNumber},"*"))}(iSlideNumber)}};var cParams="LASCmd=AI:"+m_oLightningDetails.InstanceID+";F:QP!14050&OutputFmt=1&EventKey="+m_oEventDetails.EventKey+"&SlideContentKey="+iSlideContentKey;m_oLightningDetails.SlideIACParam&&(cParams+=m_oLightningDetails.SlideIACParam);m_oGetSlideInfoAJAX.SendRequest("POST","/scripts/"+m_oLightningDetails.LASFileName,cParams)}(iSlideContentKey,bClearCache);break}case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:var cURL="/scripts/"+m_oLightningDetails.LASFileName+"?LASCmd=AI:"+m_oLightningDetails.InstanceID+";F:QP!14050&EventKey="+m_oEventDetails.EventKey+"&SlideContentKey="+oData.SlideContentKey;m_oLightningDetails.SlideIACParam&&(cURL+=m_oLightningDetails.SlideIACParam),IFrameLoad(cURL);break;case 13:!function(iSlideContentKey){m_oGetSlideInfoAJAX.Abort(),m_oGetSlideInfoAJAX.OnComplete=function(cResult){var oJSON=InxpoAJAXEvalJSON(cResult);if(oJSON.SlideContentKey==iSlideContentKey){var oData=m_oSlideDataMap[iSlideContentKey];if(oData.AutoLoop=(oData.SlideFlags&FLAG_LOOP_VIDEO)==FLAG_LOOP_VIDEO,AddToSlideDataMap(iSlideContentKey,oJSON),!(m_oCurrentContentObject instanceof AxiomMediaPlayer)){var oContainer;oData.bCreateMediaOverlay?(oContainer=_this.CreateMediaSlidePlayPauseOverlay(oData),m_oLocalContent.appendChild(oContainer)):oContainer=m_oLocalContent;var oVideoContainer=document.createElement("div");oVideoContainer.style.width="100%",oVideoContainer.style.height="100%",oContainer.appendChild(oVideoContainer);var oParams={};if(oParams.MediaContainer=oVideoContainer,oParams.PreventAutoPlay=oData.bPreventAutoPlay,oParams.DetectMediaType=!0,m_oCurrentContentObject=new AxiomMediaPlayer(oParams),oData.bCreateMediaPlayerUI){var m_oAxiomMediaPlayerUI=new AxiomMediaPlayerUI(m_oCurrentContentObject,oContainer,null,null,{hideTopControlsSection:!0,hideSeekBarSection:!0,hideMediaControlsSection:!0,hideTimeSection:!0,hideQualityLevelsSection:!0,hideFullScreenSection:!0});m_oAxiomMediaPlayerUI.showControls(!0)}oData.bPreventAutoPlay||m_oCurrentContentObject.setHandler(AXIOM_MEDIA_PLAYER_AUTO_PLAY_FAILED,function(){m_oCurrentContentObject&&m_oCurrentContentObject.play()}),m_oCurrentContentObject.setHandler(AXIOM_MEDIA_PLAYER_METADATA_LOADED,_this.MediaSlideMetaDataLoaded),m_oCurrentContentObject.setHandler(AXIOM_MEDIA_PLAYER_METADATA_LOADED,function(){m_oCurrentContentObject&&(m_oCurrentContentObject.setAutoLoop(oData.AutoLoop),!oData.bPreventAutoPlay&&m_oCurrentContentObject.isPaused()&&m_oCurrentContentObject.play())})}m_oCurrentContentObject.load(oData.ContentHTML),m_oCurrentContentObject.setAutoLoop(oData.AutoLoop)}};var cParams="LASCmd=AI:"+m_oLightningDetails.InstanceID+";F:QP!14050&OutputFmt=1&EventKey="+m_oEventDetails.EventKey+"&SlideContentKey="+iSlideContentKey;m_oLightningDetails.SlideIACParam&&(cParams+=m_oLightningDetails.SlideIACParam);m_oGetSlideInfoAJAX.SendRequest("POST","/scripts/"+m_oLightningDetails.LASFileName,cParams)}(iSlideContentKey),LocalContentLoad()}return bValid}function IFrameLoad(cURL){ToggleIFrame(!0),ToggleLocalContent(!1),CleanUpSlideArea(),m_oCurrentContentObject=m_oCurrentContentElem=m_oIFrame,m_oIFrame.src=RandomizeURL(cURL)}function LocalContentLoad(oDiv){ToggleIFrame(!1),ToggleLocalContent(!0),oDiv&&(m_oLocalContent.innerHTML="",m_oLocalContent.appendChild(oDiv))}function ToggleIFrame(bShow){m_oIFrame&&(m_oIFrame.style.display=bShow?"":"none")}function ToggleLocalContent(bShow){m_oLocalContent&&(m_oLocalContent.style.display=bShow?"":"none")}function CleanUpSlideArea(){m_oCurrentContentObject&&m_oCurrentContentObject instanceof AxiomMediaPlayer&&(m_oCurrentContentObject.destroy(),m_oLocalContent.innerHTML="",m_oCurrentContentElem&&m_oCurrentContentElem!=m_oIFrame&&m_oCurrentContentElem.parentNode&&(m_oCurrentContentElem.parentNode.removeChild(m_oCurrentContentElem),m_oCurrentContentElem=null))}function AddToSlideDataMap(iKey,oNewData){var oExistingData=m_oSlideDataMap[iKey];if(oExistingData)for(var cKey in oNewData)oExistingData[cKey]=oNewData[cKey];else m_oSlideDataMap[iKey]=oNewData}function onReceiveMessage(oEvent){var oMessage=oEvent.data;switch(oMessage.Type){case"SlideLoaded":_this.PowerPointPageLoaded();break;case"SlideComplete":m_iCurrentStep=oMessage.CurrentStep,m_iTotalSteps=oMessage.TotalSteps,oMessage.SlideIndex,_this.PowerPointLoadComplete(oMessage.SlideIndex,oMessage.CurrentStep,oMessage.TotalSteps);break;case"SlideAnimationComplete":m_iCurrentStep=oMessage.CurrentStep,_this.PowerPointAnimationComplete(oMessage.SlideIndex,oMessage.CurrentStep,oMessage.TotalSteps)}}_this.ProcessSlideData=function(oSlideData){var oData;for(var cKey in oSlideData)(oData=oSlideData[cKey]).SlideContentKey&&AddToSlideDataMap(oData.SlideContentKey,oData)},_this.DisplaySlide=function(iSlideContentKey,fnOnCompleteCallback,bClearCache){var oData=m_oSlideDataMap[iSlideContentKey];oData&&void 0!=oData.ContentType&&void 0!=oData.SlideFlags?RenderSlide(iSlideContentKey,!1,bClearCache)&&fnOnCompleteCallback&&fnOnCompleteCallback(oData):function(iSlideContentKey,fnOnCompleteCallback){m_oGetSlideInfoAJAX.Abort(),m_oGetSlideInfoAJAX.OnComplete=function(cResult){var oJSON=InxpoAJAXEvalJSON(cResult);if(oJSON.ResultSet[0].length){var oData=oJSON.ResultSet[0][0];fnOnCompleteCallback&&fnOnCompleteCallback(oData)}};var cParams="LASCmd=AI:"+m_oLightningDetails.InstanceID+";F:LBSEXPORT!JSON&IncludeEmptyResultSets=1&SQLID=18601&EventKey="+m_oEventDetails.EventKey+"&SlideContentKey="+iSlideContentKey;m_oGetSlideInfoAJAX.SendRequest("POST","/scripts/"+m_oLightningDetails.LASFileName,cParams)}(iSlideContentKey,function(oSlideData){oSlideData&&(m_oSlideDataMap[iSlideContentKey]=oSlideData,RenderSlide(iSlideContentKey,!1,bClearCache)&&fnOnCompleteCallback&&fnOnCompleteCallback(oSlideData))})},_this.DisplayURL=function(cURL,fnOnCompleteCallback){var oData={ContentHTML:cURL,ContentType:CONTENT_TYPE_RENDER_URL,SlideContentKey:-1};m_oSlideDataMap[-1]=oData,RenderSlide(-1)&&fnOnCompleteCallback&&fnOnCompleteCallback(oData)},_this.GetCurrentSlide=function(){return m_oCurrentSlide},_this.GetCurrentSlideContent=function(){return m_oCurrentContentObject},_this.PerformSlideAction=function(iDirection,bForce){if(!iDirection||!m_oIFrame)return-1;var iMovements=0;if(bForce)for(;iDirection;)iDirection<0?(iDirection++,m_oIFrame.contentWindow.postMessage({Type:"PreviousStep"},"*")):(iDirection--,m_oIFrame.contentWindow.postMessage({Type:"NextStep"},"*")),iMovements++;else{var iTargetState=Math.max(Math.min(m_iCurrentStep+iDirection,m_iTotalSteps),0);if(0==iTargetState||iTargetState>m_iTotalSteps);else if(iTargetState<m_iCurrentStep)for(var iCurrentState=m_iCurrentStep;iCurrentState!=iTargetState;)m_oIFrame.contentWindow.postMessage({Type:"PreviousStep"},"*"),iMovements++,iCurrentState--;else for(iCurrentState=m_iCurrentStep;iCurrentState!=iTargetState;)m_oIFrame.contentWindow.postMessage({Type:"NextStep"},"*"),iMovements++,iCurrentState++}return iMovements},_this.SetEmpty=function(){m_oCurrentSlide=null,LocalContentLoad(document.createElement("div"))},_this.JumpToStep=function(iStep){ToggleIFrame(!0),ToggleLocalContent(!1),CleanUpSlideArea(),m_oIFrame&&(m_oCurrentContentObject=m_oCurrentContentElem=m_oIFrame,m_oIFrame.contentWindow.postMessage({Type:"JumpToStep",StepIndex:iStep},"*"))},_this.SetPageSize=function(oSize){if(_this.IsCurrentContentIFrame())try{m_oIFrame.contentWindow&&"function"==typeof m_oIFrame.contentWindow.SetPageSize&&m_oIFrame.contentWindow.SetPageSize(oSize)}catch(ex){}},_this.IsCurrentContentIFrame=function(){return m_oIFrame&&m_oCurrentContentElem==m_oIFrame},_this.EnableRendering=function(oContainer){(m_bEnableRendering=!!(m_oParentContainer=oContainer))&&(m_oParentContainer.innerHTML="",(m_oIFrame=document.createElement("iframe")).style.height="100%",m_oIFrame.style.width="100%",m_oIFrame.setAttribute("frameborder","0"),m_oIFrame.setAttribute("seamless",!0),m_oParentContainer.appendChild(m_oIFrame),window.addEventListener("message",onReceiveMessage),(m_oLocalContent=document.createElement("div")).style.height="100%",m_oLocalContent.style.width="100%",m_oParentContainer.appendChild(m_oLocalContent),ToggleIFrame(!1),ToggleLocalContent(!1),m_oCurrentSlide=null)},_this.DisableRendering=function(){m_oIFrame&&(m_oIFrame.parentNode&&m_oIFrame.parentNode.removeChild(m_oIFrame),m_oIFrame=null),m_oLocalContent&&(m_oLocalContent.parentNode&&m_oLocalContent.parentNode.removeChild(m_oLocalContent),m_oLocalContent=null),m_bEnableRendering=!1,m_oParentContainer=null,m_oCurrentSlide=null},m_oGetSlideInfoAJAX=new InxpoAJAXObject}SlideManager.prototype.ApproveSlide=function(oSlide){return!0},SlideManager.prototype.PowerPointPageLoaded=function(){},SlideManager.prototype.PowerPointAnimationComplete=function(iSlideIndex,iCurrentStep,iTotalSteps){},SlideManager.prototype.PowerPointLoadComplete=function(iSlideIndex,iCurrentStep,iTotalSteps){},SlideManager.prototype.CreateMediaSlidePlayPauseOverlay=function(oSlide){return document.createElement("div")},SlideManager.prototype.MediaSlideMetaDataLoaded=function(oEvent){};