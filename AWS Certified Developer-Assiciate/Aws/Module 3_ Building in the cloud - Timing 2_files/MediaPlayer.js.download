var AXIOM_MEDIA_PLAYER_CLICK="Click",AXIOM_MEDIA_PLAYER_PLAY="Play",AXIOM_MEDIA_PLAYER_PAUSE="Pause",AXIOM_MEDIA_PLAYER_SEEKING="Seeking",AXIOM_MEDIA_PLAYER_SEEKED="Seeked",AXIOM_MEDIA_PLAYER_COMPLETE="Complete",AXIOM_MEDIA_PLAYER_ERROR="ERROR",AXIOM_MEDIA_PLAYER_PLAYBACK_ERROR="PlaybackError",AXIOM_MEDIA_PLAYER_QUALITY_CHANGE="QualityChange",AXIOM_MEDIA_PLAYER_QUALITY_COMPLETED="QualityCompleted",AXIOM_MEDIA_PLAYER_BUFFER_UPDATED="BufferUpdate",AXIOM_MEDIA_PLAYER_VOLUME_CHANGE="VolumeChange",AXIOM_MEDIA_PLAYER_DURATION_CHANGE="DurationChange",AXIOM_MEDIA_PLAYER_METADATA_LOADED="MetadataLoaded",AXIOM_MEDIA_PLAYER_DATA_LOADED="DataLoaded",AXIOM_MEDIA_PLAYER_METADATA_MEDIASWITCH_LOADED="MediaSwitchMetadataLoaded",AXIOM_MEDIA_PLAYER_TIME_UPDATE="TimeUpdate",AXIOM_MEDIA_PLAYER_DEBUG="Debug",AXIOM_MEDIA_PLAYER_RTC_UPDATE="RTCUpdate",AXIOM_MEDIA_PLAYER_AV_SWITCH="AVSwitch",AXIOM_MEDIA_PLAYER_WEBKIT_END_FULLSCREEN="WebkitEndFullscreen",AXIOM_MEDIA_PLAYER_RECOVER_MAX="MediaRecoverMax",AXIOM_MEDIA_PLAYER_AUTO_PLAY_FAILED="MediaAutoPlayFail",AXIOM_MEDIA_PLAYER_BUFFER_UPDATED_LIVE="BufferUpdateLive",AXIOM_MEDIA_PLAYER_QUALITY_SET="QualitySet",AXIOM_MEDIA_PLAYER_STALLED="Stalled",AXIOM_MEDIA_PLAYER_CUSTOM_HEADERS="CustomHeaders",AXIOM_MEDIA_PLAYER_TEXT_TRACK_CUE_CHANGE="TextCueChange",AXIOM_MEDIA_PLAYER_REBUILDING="rebuilding";function AxiomMediaPlayer(oParams,oSettings){var _this=this;this.m_oSettings=oSettings,this.m_oParams=oParams,this.m_oParams.DefaultVolume||(this.m_oParams.DefaultVolume=1);var iUserVolume=localStorage.getItem("SUV");iUserVolume&&!isNaN(1*iUserVolume)&&(this.m_oParams.DefaultVolume=1*iUserVolume),this.bWebRTC=!1,this.bDash=!1,this.bHLS=!1,this.bHTML5=!1,this.bIOS=IsIOS(),this.bTHEO=!1,this.bLoaded=!1,this.bIsLive=oParams.Live,this.bScreenShare=oParams.ScreenShare,this.bShaka=!1,this.bPendingMediaSwitch=!1,this.oWebRTC=null,this.m_oPlayer=null,this.m_oPlayerWrapper=null,this.m_iDashLiveDelaySeconds=!oSettings||isNaN(oSettings.DashLiveDelaySeconds)?2:oSettings.DashLiveDelaySeconds,this.m_iDashSeekSizeSeconds=oSettings?oSettings.DashSeekSizeSeconds:0,this.m_oCallHandlers={},this.m_oCommManager=oParams.CommManager,this.m_cSocketName=oParams.SocketName,this.m_oMediaContainer=oParams.MediaContainer,Object.defineProperty(this,"m_oMedia",{get:function(){return _this.m_oPlayerWrapper?_this.m_oPlayerWrapper.getMediaObject():null}}),this.m_bTrackView=oParams.TrackView,this.m_bAudioOnly=oParams.AudioOnly,this.m_bAudioTag=oParams.AudioOnly,this.m_bAutoPlay=!oParams.PreventAutoPlay,this.m_bAutoLoop=!1,this.m_bInitialPlay=!1,this.m_cAttendeeKey=oSettings?oSettings.EventAttendeeKey:0,this.m_iOutputKey=0,this.m_iIACServerKey=0,this.m_cInternalIPAddress="",this.m_cIACServerName="",this.CDNType=CDN_TYPE_CDN,this.m_iStreamType=0,this.m_iPlayerType=0,this.m_iLastTotalByteCount=0,this.m_iBufferStartTime=0,this.m_iAudioBufferStartTime=0,this.m_aAudioSegments=[],this.m_aVideoSegments=[],this.m_iFailure=0,this.m_iTotalAudioOnly=0,this.m_iSumQualityLevels=0,this.m_cInternalFlID=null,this.m_bInternalFlReady=!1,this.m_iInitPlayerTime=0,this.m_iPreviousTime=0,this.m_iMediaErrorCount=0,this.MAX_REQUEST_TIME=3e3,this.MAX_REQUEST_COUNT=2,this.MAX_CHECK_COUNT=6,this.MAX_MEDIA_ERROR=2,this.MAX_MEDIA_RELOAD=10,this.m_iSeekTime=0,this.m_bReload=!1,this.m_bOverrideMediaCheck=!oParams.Live,this.m_iLastMediaViewSaveTime=0,this.m_iMediaDurationWatched=0,this.m_bWindowUnloadSaved=!1,this.m_iWidth=oParams.Width,this.m_iHeight=oParams.Height,this.m_iRecoverMaxCount=0,this.m_bVideoBufferReady=!1,this.m_bPendingUserInitiated=!1,this.m_iPendingQualityLevel=-2,this.m_iCurrentQualityLevel=-2,this.m_iPreviousQualityLevel=-2,this.m_aTracks=null,this.m_oPlayerStats={Duration:0},this.m_iLowBufferCount=0,this.m_bInitialLoad=!1,this.m_iInitialTimeoutID=0,this.m_oBufferLevels={video:0,audio:0},this.m_bPendingStop=!1,this.m_bAutoPlayChecked=!1,this.m_cBypassCache="",this.m_aLoadScripts=[],this.m_oSrcToPlayerWrapperMap={},this._init2()}var amp={};function CancelEvent(evt){return evt&&(evt.cancelBubble=!0,evt.stopPropagation&&evt.stopPropagation(),evt.preventDefault&&evt.preventDefault(),evt.returnValue=!1),!1}function DefaultVideoWrapper(){var m_oMedia,m_oPlayer,m_oContent,m_bStopPending,m_cSourceURL,m_cSourceContentType,m_bSuppressEvents,m_iSeekTo,m_bCanPlayTriggered,m_iPendingSeekTime,_this=this,m_bAudioOnlyState=!1;function buildPlayer(){m_oMedia&&m_oMedia.parentNode&&m_oMedia.parentNode.removeChild(m_oMedia),m_oMedia=function(){var oMedia=document.createElement(m_bAudioOnlyState?"audio":"video");oMedia.style.width="100%",oMedia.style.height="100%",oMedia.addEventListener("contextmenu",function(event){return event.preventDefault(),!1}),IsIOS()&&(oMedia.setAttribute("preload","metadata"),oMedia.setAttribute("playsinline",!0),oMedia.setAttribute("webkit-playsinline",!0));return oMedia.addEventListener("canplay",onCanPlayEvent),oMedia.addEventListener("durationchange",onEvent),oMedia.addEventListener("ended",onEvent),oMedia.addEventListener("error",onErrorEvent),oMedia.addEventListener("loadeddata",onEvent),oMedia.addEventListener("loadedmetadata",onEvent),oMedia.addEventListener("pause",onEvent),oMedia.addEventListener("play",onEvent),oMedia.addEventListener("playing",onPlayingEvent),oMedia.addEventListener("seeked",onEvent),oMedia.addEventListener("timeupdate",onEvent),oMedia.addEventListener("volumechange",onEvent),oMedia.addEventListener("webkitendfullscreen",onEvent),oMedia}(),m_oContent.appendChild(m_oMedia),m_oPlayer=m_oMedia}function onEvent(oEvent){if(!m_bSuppressEvents){var oCustom;for(var cKey in"function"==typeof CustomEvent?oCustom=new CustomEvent(oEvent.type):(oCustom=document.createEvent("CustomEvent")).initCustomEvent(oEvent.type,!0,!1,oEvent),oEvent)void 0==oCustom[cKey]&&(oCustom[cKey]=oEvent[cKey]);_this.element.dispatchEvent(oCustom)}}function onCanPlayEvent(oEvent){if(m_bCanPlayTriggered=!0,m_iPendingSeekTime){var iTime=m_iPendingSeekTime;m_iPendingSeekTime=0,_this.currentTime=iTime}}function onPlayingEvent(oEvent){m_iSeekTo>=0&&(_this.currentTime=m_iSeekTo,m_iSeekTo=-1),m_bSuppressEvents=!1,onEvent(oEvent)}function onErrorEvent(oEvent){m_bStopPending&&(oEvent={type:"ended",currentTarget:m_oMedia}),onEvent(oEvent)}function getTextTrackIdentifier(){var iID=-1;if(m_oPlayer.textTracks)for(var aFullTracks=m_oPlayer.textTracks,iLup=0;iLup<aFullTracks.length;iLup++)if("showing"==aFullTracks[iLup].mode){iID=iLup;break}return iID}this.loadSource=function(cSource,cContentType,oStreamingParameters,iSeekTo){m_cSourceURL=cSource,m_cSourceContentType=cContentType,m_bSuppressEvents=!1,m_oPlayer.src=m_cSourceURL,m_iSeekTo=iSeekTo>=0?iSeekTo:-1},Object.defineProperty(this,"audioOnly",{get:function(){return m_bAudioOnlyState},set:function(val){if(m_bAudioOnlyState!=val&&(m_bAudioOnlyState=val,m_oPlayer)){var bPaused=_this.paused;_this.reload(_this.currentTime),m_cSourceURL&&(bPaused||_this.play(),onEvent({type:AXIOM_MEDIA_PLAYER_AV_SWITCH,hasVideo:!m_bAudioOnlyState})),m_bSuppressEvents=!0}}}),Object.defineProperty(this,"autoplay",{get:function(){return m_oMedia.autoplay},set:function(val){m_oMedia.autoplay=val}}),Object.defineProperty(this,"autoBitrate",{get:function(){return!1}}),Object.defineProperty(this,"currentTime",{get:function(){return m_oMedia.currentTime},set:function(val){m_bCanPlayTriggered?m_oMedia.currentTime=val<0?9999999:val:m_iPendingSeekTime=val}}),Object.defineProperty(this,"duration",{get:function(){return m_oMedia.duration}}),Object.defineProperty(this,"loop",{get:function(){return m_oMedia.loop},set:function(val){m_oMedia.loop=val}}),Object.defineProperty(this,"muted",{get:function(){return m_oMedia.muted},set:function(val){m_oMedia.muted=val}}),Object.defineProperty(this,"paused",{get:function(){return m_oMedia.paused},set:function(val){m_oMedia.paused=val}}),Object.defineProperty(this,"src",{get:function(){return m_cSourceURL}}),Object.defineProperty(this,"stopPending",{get:function(){return m_bStopPending},set:function(val){m_bStopPending=val}}),Object.defineProperty(this,"textTrackVisible",{get:function(){return getTextTrackIdentifier()>-1},set:function(val){!function(bShow){if(m_oPlayer.textTracks){var aFullTracks=m_oPlayer.textTracks;if(bShow)aFullTracks.length&&(aFullTracks[0].mode="showing");else{aFullTracks=m_oPlayer.textTracks;for(var iLup=0;iLup<aFullTracks.length;iLup++)oTrack=aFullTracks[iLup],oTrack.mode="hidden"}}}(val)}}),Object.defineProperty(this,"currentTextTrackId",{get:function(){return getTextTrackIdentifier()},set:function(val){!function(cID){if(m_oPlayer.textTracks)for(var aFullTracks=m_oPlayer.textTracks,iIndex=parseInt(cID),iLup=0;iLup<aFullTracks.length;iLup++)aFullTracks[iLup].mode=iLup==iIndex?"showing":"hidden"}(val)}}),Object.defineProperty(this,"textTracks",{get:function(){return function(){var oTrack,aTracks=[];if(m_oPlayer.textTracks)for(var aFullTracks=m_oPlayer.textTracks,iLup=0;iLup<aFullTracks.length;iLup++)oTrack=aFullTracks[iLup],aTracks.push({id:iLup,title:oTrack.label,language:oTrack.language});return aTracks}()}}),Object.defineProperty(this,"volume",{get:function(){return m_oMedia.volume},set:function(val){m_oMedia.volume=val}}),this.addEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.addEventListener(cEventType,fnFunction,bUseCapture)},this.removeEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.removeEventListener(cEventType,fnFunction,bUseCapture)},this.destroy=function(){m_oMedia&&m_oMedia.parentNode&&m_oMedia.parentNode.removeChild(m_oMedia),m_oMedia=null},this.getPlayerObject=function(){return m_oPlayer},this.getMediaObject=function(){return m_oMedia},this.getStats=function(){var oReturn={bufferingTime:0,duration:0,lastSegmentLoadTime:0,lastSegmentLength:0,totalByteCount:0,totalSegmentCount:0,adaptationUpCount:0,adaptationDownCount:0,audioOnlyAdapataionCount:0};return oReturn},this.pause=function(){m_oMedia.pause()},this.play=function(){m_oMedia.play()},this.reload=function(iSeekTo){onEvent({type:AXIOM_MEDIA_PLAYER_REBUILDING,source:m_cSourceURL,contentType:m_cSourceContentType}),buildPlayer(),m_cSourceURL&&_this.loadSource(m_cSourceURL,m_cSourceContentType,null,iSeekTo)},this.unload=function(){m_oMedia.src=""},(m_oContent=document.createElement("div")).style.width="100%",m_oContent.style.height="100%",m_oContent.style.backgroundColor="black",_this.element=m_oContent,buildPlayer()}function ShakaWrapper(){var m_oMedia,m_oPlayer,m_oContent,m_bHLS,m_oHLSManifestParser,m_iHLSTargetDuration,m_oVariantMap,m_cAppendAdditionalParams,m_bTrackRequest,m_iTrackRequestCount,m_iTrackRequestMax,m_iLastBuffering,m_iTotalSegmentCount,m_iLastSegmentLoadTime,m_iLastSegmentLength,m_iTotalByteCount,m_aoAudioOnlyTracks,m_iSegmentLookupOffset,m_bStopPending,m_cSourceURL,m_cSourceContentType,m_oStreamingParameters,_this=this,m_bAudioOnlyState=!1,m_iMaxReuildsFromError=10,m_iCurrentRebuildsFromError=0,UNKNOWN=4,m_bLoadedData=!1;function buildPlayer(){m_oMedia&&m_oMedia.parentNode&&m_oMedia.parentNode.removeChild(m_oMedia),m_oMedia=function(){var oMedia=document.createElement(m_bAudioOnlyState?"audio":"video");oMedia.style.width="100%",oMedia.style.height="100%",oMedia.addEventListener("contextmenu",function(event){return event.preventDefault(),!1}),IsIOS()&&(oMedia.setAttribute("preload","metadata"),oMedia.setAttribute("playsinline",!0),oMedia.setAttribute("webkit-playsinline",!0));return oMedia.addEventListener("canplay",onCanPlayEvent),oMedia.addEventListener("play",onEvent),oMedia.addEventListener("pause",onEvent),oMedia.addEventListener("loadeddata",onLoadedData),oMedia.addEventListener("loadedmetadata",onLoadedMetadata),oMedia.addEventListener("volumechange",onEvent),oMedia.addEventListener("durationchange",onEvent),oMedia.addEventListener("timeupdate",onEvent),oMedia.addEventListener("webkitendfullscreen",onEvent),oMedia.addEventListener("seeked",onEvent),oMedia.addEventListener("ended",onEvent),oMedia}(),m_oContent.appendChild(m_oMedia),m_oPlayer&&(m_oPlayer.removeEventListener("adaptation",onEvent),m_oPlayer.removeEventListener("buffering",onBufferingEvent),m_oPlayer.removeEventListener("emsg",onEvent),m_oPlayer.removeEventListener("error",onErrorEvent),m_oPlayer.removeEventListener("streaming",onStreamingEvent),m_oPlayer.destroy());var oNetworkEngine=(m_oPlayer=new shaka.Player(m_oMedia)).getNetworkingEngine();oNetworkEngine.registerRequestFilter(onRequestFilter),oNetworkEngine.registerResponseFilter(onResponseFilter),m_oPlayer.addEventListener("adaptation",onEvent),m_oPlayer.addEventListener("buffering",onBufferingEvent),m_oPlayer.addEventListener("emsg",onEvent),m_oPlayer.addEventListener("error",onErrorEvent),m_oPlayer.addEventListener("streaming",onStreamingEvent)}function onLoadedData(oEvent){m_bLoadedData||(m_bLoadedData=!0,_this.duration>0&&onEvent(oEvent))}function onLoadedMetadata(oEvent){onEvent(oEvent),onLoadedData({type:"loadeddata"})}function onEvent(oEvent){var oCustom;for(var cKey in"function"==typeof CustomEvent?oCustom=new CustomEvent(oEvent.type):(oCustom=document.createEvent("CustomEvent")).initCustomEvent(oEvent.type,!0,!1,oEvent),oEvent)void 0==oCustom[cKey]&&(oCustom[cKey]=oEvent[cKey]);_this.element.dispatchEvent(oCustom)}function onCanPlayEvent(oEvent){m_iCurrentRebuildsFromError&&_this.play(),onEvent(oEvent)}function onBufferingEvent(oEvent){oEvent.buffering?m_iLastBuffering=(new Date).getTime():m_iLastBuffering&&(oEvent.bufferingTime=(new Date).getTime()-m_iLastBuffering,m_iLastBuffering=0),onEvent(oEvent)}function onStreamingEvent(oEvent){var aFullTracks,oTrack;if(m_aoAudioOnlyTracks=[],m_oPlayer.getVariantTracks&&(aFullTracks=m_oPlayer.getVariantTracks()).length)for(var iLup=0;iLup<aFullTracks.length;iLup++)(oTrack=aFullTracks[iLup]).audioId&&!oTrack.videoId&&m_aoAudioOnlyTracks.push(oTrack);onEvent(oEvent)}function onErrorEvent(oEvent){var oError={type:"error",code:oEvent.detail.code};if(oEvent.detail)switch(oEvent.detail.code){case shaka.util.Error.Code.BAD_HTTP_STATUS:if(oEvent.detail&&oEvent.detail.data&&oEvent.detail.data[0]){var oInfo=getSegmentInfo(oEvent.detail.data[0]);oInfo&&(oError.error="http",oError.code=1*oEvent.detail.data[1],oError.stream=oInfo.type==amp.SegmentType.AUDIO?1:0,oError.segment=oInfo.segment)}break;default:return console.warn("error",oEvent.detail.code,oEvent),onEvent(oError),void(++m_iCurrentRebuildsFromError<m_iMaxReuildsFromError&&_this.reload(_this.currentTime))}onEvent(oError)}function getSegmentInfo(cSourceURI){var oReturn,oResults=cSourceURI.match(amp.HLSSegmentNumberRegex);if(oResults&&3==oResults.length){var oSegment,oPeriod,oVariant,cHash=oResults[1],iSegment=parseInt(oResults[2]),oManifest=m_oPlayer.getManifest();if(m_oVariantMap[cHash]){var oSet=m_oVariantMap[cHash];if(oSegment=oSet.source.getSegmentReference(iSegment-m_iSegmentLookupOffset))return{type:oSet.type,segment:iSegment,duration:oSegment.endTime-oSegment.startTime}}for(var iPeriod=0;iPeriod<oManifest.periods.length;iPeriod++){oPeriod=oManifest.periods[iPeriod];for(var iVariant=0;iVariant<oPeriod.variants.length&&!((oVariant=oPeriod.variants[iPeriod]).video&&oVariant.video.getSegmentReference&&(oReturn=getSegmentInfo_Helper(oVariant.video,amp.SegmentType.VIDEO,iSegment,cSourceURI,cHash)))&&!(oVariant.audio&&oVariant.audio.getSegmentReference&&(oReturn=getSegmentInfo_Helper(oVariant.audio,amp.SegmentType.AUDIO,iSegment,cSourceURI,cHash)));iVariant++);if(oReturn)break}oReturn&&(oReturn={type:UNKNOWN,segment:iSegment})}else oReturn={type:UNKNOWN,segment:-1};return oReturn}function getSegmentInfo_Helper(oStream,iType,iSegment,cSourceURI,cHash){var oSegment;if(m_iSegmentLookupOffset<0&&(oSegment=oStream.getSegmentReference(0),m_iSegmentLookupOffset=oSegment?1:0),(oSegment=oStream.getSegmentReference(iSegment-m_iSegmentLookupOffset))&&oSegment.createUris){aURIs=oSegment.createUris();for(var iLup=0;iLup<aURIs.length;iLup++)if(aURIs[iLup]==cSourceURI)return m_oVariantMap[cHash]={source:oStream,type:iType},{type:iType,segment:iSegment,duration:oSegment.endTime-oSegment.startTime}}return null}function onRequestFilter(cType,oRequest){if(cType==shaka.net.NetworkingEngine.RequestType.MANIFEST){if(m_cAppendAdditionalParams)for(var aURL=oRequest.uris,iLup=0;iLup<aURL.length;iLup++)cURL=aURL[iLup],cURL.indexOf(m_cAppendAdditionalParams)<0&&(cURL.indexOf("?")>-1?cURL+="&"+m_cAppendAdditionalParams:cURL+="?"+m_cAppendAdditionalParams,aURL[iLup]=cURL)}else cType==shaka.net.NetworkingEngine.RequestType.SEGMENT&&m_bTrackRequest&&(oRequest.headers.Pragma="akamai-x-cache-on, akamai-x-cache-remote-on, akamai-x-get-nonces, akamai-x-get-ssl-client-session-id, akamai-x-serial-no, akamai-x-feo-trace, akamai-x-get-request-id",m_bTrackRequest=!1)}function onResponseFilter(iType,oResponse){if(iType!=shaka.net.NetworkingEngine.RequestType.MANIFEST&&iType){if(iType==shaka.net.NetworkingEngine.RequestType.SEGMENT&&(m_bHLS&&m_oHLSManifestParser&&(m_oHLSManifestParser=null),m_oPlayer.isLive())){var oInfo=getSegmentInfo(oResponse.uri);if(oInfo){switch(oInfo.type){case amp.SegmentType.AUDIO:case amp.SegmentType.VIDEO:m_iLastSegmentLength=oInfo.duration,m_iTotalSegmentCount++}m_iLastSegmentLoadTime=oResponse.timeMs}var oHeaders=oResponse.headers;oHeaders&&oHeaders["x-akamai-request-id"]&&(oInfo?(++m_iTrackRequestCount<m_iTrackRequestMax&&setTimeout(function(){m_bTrackRequest=!0},750*m_iTrackRequestCount),oInfo.type==amp.SegmentType.VIDEO?oHeaders.Stream=0:oInfo.type==amp.SegmentType.AUDIO&&(oHeaders.Stream=1),oHeaders.Segment=oInfo.segment,oHeaders.type=AXIOM_MEDIA_PLAYER_CUSTOM_HEADERS,onEvent(oHeaders)):m_bTrackRequest=!0)}}else if(m_bHLS&&m_oHLSManifestParser&&"m3u8"==oResponse.uri.substring(oResponse.uri.length-4)){var oResults=m_oHLSManifestParser.parsePlaylist(oResponse.data,oResponse.uri,10);if(oResults.version>3&&m_iHLSTargetDuration<oResults.targetDuration){m_iHLSTargetDuration=oResults.targetDuration;m_oPlayer.getConfiguration();m_oPlayer.configure({manifest:{availabilityWindowOverride:3*m_iHLSTargetDuration}}),m_oPlayer.getConfiguration()}}m_iTotalByteCount+=Math.round(oResponse.data.byteLength)}this.startTrackingRequestsFor=function(iCount){m_bTrackRequest=!0,m_iTrackRequestCount=0,m_iTrackRequestMax=iCount},this.loadSource=function(cSource,cContentType,oStreamingParameters,iSeekTo){m_bLoadedData=!1,m_oVariantMap={},m_iSegmentLookupOffset=-1,-1,m_aoAudioOnlyTracks=[];var oCustonParser=null,iM3U8Index=cSource.indexOf(".m3u8");if("application/x-mpegURL"==cContentType||iM3U8Index>-1){if(!window.muxjs)return void LoadScript(g_oSettings.ScriptDir+"/ThirdParty/muxjs/5.1.2/mux.js",function(){_this.loadSource(cSource,cContentType,oStreamingParameters)});iM3U8Index<0&&(oCustonParser=shaka.hls.HlsParser),m_iHLSTargetDuration=0,m_oHLSManifestParser=new HLSManifestParser,m_bHLS=!0}if(m_cAppendAdditionalParams=null,cSource.indexOf("?")>0){var aResults=cSource.split("?");aResults&&2==aResults.length&&(m_cAppendAdditionalParams=aResults[1])}m_iTotalSegmentCount=0,m_iTotalByteCount=0;var oManifestParameters={dash:{clockSyncUri:"https://time.akamai.com/"},retryParameters:{maxAttempts:3,baseDelay:500,backoffFactor:1.5,fuzzFactor:.5}};m_oPlayer.configure({manifest:oManifestParameters,streaming:oStreamingParameters}),m_cSourceURL=cSource,m_cSourceContentType=cContentType,m_oStreamingParameters=oStreamingParameters,m_oPlayer.load(cSource,null,oCustonParser).then(function(a,b,c){iSeekTo&&(_this.currentTime=iSeekTo)}).catch(function(a,b,c){console.log("Error",a,b,c)})},Object.defineProperty(this,"audioOnly",{get:function(){return m_bAudioOnlyState},set:function(val){m_bAudioOnlyState!=val&&(m_bAudioOnlyState=val,m_oPlayer&&(_this.reload(_this.currentTime),m_cSourceURL&&onEvent({type:AXIOM_MEDIA_PLAYER_AV_SWITCH,hasVideo:!m_bAudioOnlyState})))}}),Object.defineProperty(this,"autoplay",{get:function(){return m_oMedia.autoplay},set:function(val){m_oMedia.autoplay=val}}),Object.defineProperty(this,"autoBitrate",{get:function(){var bAuto=!1,oConfig=m_oPlayer.getConfiguration();return oConfig&&oConfig.abr&&(bAuto=oConfig.abr.enabled),bAuto}}),Object.defineProperty(this,"currentTime",{get:function(){return m_oMedia.currentTime},set:function(val){m_oMedia.currentTime=val}}),Object.defineProperty(this,"duration",{get:function(){return m_oMedia.duration}}),Object.defineProperty(this,"loop",{get:function(){return m_oMedia.loop},set:function(val){m_oMedia.loop=val}}),Object.defineProperty(this,"muted",{get:function(){return m_oMedia.muted},set:function(val){m_oMedia.muted=val}}),Object.defineProperty(this,"paused",{get:function(){return m_oMedia.paused},set:function(val){m_oMedia.paused=val}}),Object.defineProperty(this,"currentQualityLevelId",{get:function(){return function(){var iLup,aFullTracks,iLevel=-1;if(m_oPlayer.getTracks){for(aFullTracks=m_oPlayer.getTracks(),iLup=0;iLup<aFullTracks.length;iLup++)if("video"==aFullTracks[iLup].type&&aFullTracks[iLup].active){iLevel=aFullTracks[iLup].id;break}}else if(m_oPlayer.getVariantTracks)for(aFullTracks=m_oPlayer.getVariantTracks(),iLup=0;iLup<aFullTracks.length;iLup++)if(aFullTracks[iLup].videoId&&aFullTracks[iLup].active){iLevel=aFullTracks[iLup].id;break}return iLevel}()},set:function(val){!function(cID){if(-1==cID)m_oPlayer.configure({abr:{enabled:!0}});else{m_oPlayer.configure({abr:{enabled:!1}});var aFullTracks,iLup=0,oTrack=null;if(m_oPlayer.getTracks){for(aFullTracks=m_oPlayer.getTracks(),iLup=0;iLup<aFullTracks.length;iLup++)if("video"==aFullTracks[iLup].type&&aFullTracks[iLup].id==cID){oTrack=aFullTracks[iLup];break}oTrack&&m_oPlayer.selectTrack(oTrack)}else if(m_oPlayer.getVariantTracks){for(aFullTracks=m_oPlayer.getVariantTracks(),iLup=0;iLup<aFullTracks.length;iLup++)if(aFullTracks[iLup].videoId&&aFullTracks[iLup].id==cID){oTrack=aFullTracks[iLup];break}oTrack&&m_oPlayer.selectVariantTrack(oTrack)}}}(val)}}),Object.defineProperty(this,"qualityLevels",{get:function(){return function(){var aFullTracks,oTrack,iBitrate,aTracks=[];if(m_oPlayer.getVariantTracks&&(aFullTracks=m_oPlayer.getVariantTracks()).length)for(var iLup=0;iLup<aFullTracks.length;iLup++)iBitrate=(oTrack=aFullTracks[iLup]).videoBandwidth?oTrack.videoBandwidth:oTrack.bandwidth?oTrack.bandwidth:0,oTrack.audioBandwidth&&(iBitrate+=oTrack.audioBandwidth),aTracks.push({bitrate:iBitrate,qualityIndex:oTrack.id});return aTracks&&aTracks.length>1&&(aTracks.sort(function(oA,oB){return oB.bitrate-oA.bitrate}),aTracks.length),aTracks}()}}),Object.defineProperty(this,"src",{get:function(){return m_cSourceURL}}),Object.defineProperty(this,"stopPending",{get:function(){return m_bStopPending},set:function(val){m_bStopPending=val,m_oPlayer&&m_oPlayer.configure({streaming:{retryParameters:{maxAttempts:1,baseDelay:6e5,backoffFactor:0,fuzzFactor:1}}})}}),Object.defineProperty(this,"textTrackVisible",{get:function(){return m_oPlayer.isTextTrackVisible()},set:function(val){m_oPlayer.setTextTrackVisibility(val)}}),Object.defineProperty(this,"currentTextTrackId",{get:function(){return function(){var iLup,aFullTracks,iID=-1;if(m_oPlayer.getTextTracks)for(aFullTracks=m_oPlayer.getTextTracks(),iLup=0;iLup<aFullTracks.length;iLup++)if("text"==aFullTracks[iLup].type&&aFullTracks[iLup].active){iID=aFullTracks[iLup].id;break}return iID}()},set:function(val){!function(cID){var oTrack,aFullTracks,iLup=0,oTrackFound=null;if(m_oPlayer.getTextTracks){var bInitialState=_this.textTrackVisible;for(bInitialState&&(_this.textTrackVisible=!1),aFullTracks=m_oPlayer.getTextTracks(),iLup=0;iLup<aFullTracks.length;iLup++)"text"==(oTrack=aFullTracks[iLup]).type&&oTrack.id==cID?(oTrackFound=oTrack).active=!0:oTrack.active=!1;oTrackFound&&m_oPlayer.selectTextTrack(oTrackFound),bInitialState&&(_this.textTrackVisible=!0)}}(val)}}),Object.defineProperty(this,"textTracks",{get:function(){return function(){var aFullTracks,oTrack,aTracks=[];if(m_oPlayer.getTextTracks){aFullTracks=m_oPlayer.getTextTracks();for(var iLup=0;iLup<aFullTracks.length;iLup++)oTrack=aFullTracks[iLup],aTracks.push({id:oTrack.id,title:oTrack.originalTextId,language:oTrack.language})}return aTracks}()}}),Object.defineProperty(this,"volume",{get:function(){return m_oMedia.volume},set:function(val){m_oMedia.volume=val}}),this.addEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.addEventListener(cEventType,fnFunction,bUseCapture)},this.destroy=function(){m_oPlayer&&m_oPlayer.destroy&&m_oPlayer.destroy(),this.m_oMediaContainer&&this.m_oMedia&&(this.m_oMediaContainer.removeChild(this.m_oMedia),this.m_oMedia=null,this.m_oMediaContainer=null)},this.getPlayerObject=function(){return m_oPlayer},this.getMediaObject=function(){return m_oMedia},this.getStats=function(){var oStats=m_oPlayer.getStats(),oReturn={};oReturn.bufferingTime=1e3*oStats.bufferingTime,oReturn.lastSegmentLoadTime=m_iLastSegmentLoadTime,oReturn.lastSegmentLength=1e3*m_iLastSegmentLength,oReturn.totalByteCount=m_iTotalByteCount,oReturn.totalSegmentCount=m_iTotalSegmentCount,oReturn.adaptationUpCount=0,oReturn.adaptationDownCount=0,oReturn.audioOnlyAdapataionCount=0;for(var oState,iLup2,aHistory=oStats.switchHistory,iBandwidth=-1,iLup=0;iLup<aHistory.length;iLup++){if(oState=aHistory[iLup],m_aoAudioOnlyTracks.length)for(iLup2=0;iLup2<m_aoAudioOnlyTracks.length;iLup2++)oState.bandwidth==m_aoAudioOnlyTracks[iLup2].audioBandwidth&&oReturn.audioOnlyAdapataionCount++;-1!=iBandwidth?(oState.bandwidth>iBandwidth?oReturn.adaptationUpCount++:oReturn.adaptationDownCount++,iBandwidth=oState.bandwidth):iBandwidth=oState.bandwidth}return oReturn},this.pause=function(){m_oMedia.pause()},this.play=function(){m_oMedia.play()},this.reload=function(iSeekTo){onEvent({type:AXIOM_MEDIA_PLAYER_REBUILDING,source:m_cSourceURL,contentType:m_cSourceContentType}),buildPlayer(),m_cSourceURL&&_this.loadSource(m_cSourceURL,m_cSourceContentType,m_oStreamingParameters,iSeekTo)},this.removeEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.removeEventListener(cEventType,fnFunction,bUseCapture)},this.unload=function(){m_oPlayer.unload()},(m_oContent=document.createElement("div")).style.width="100%",m_oContent.style.height="100%",m_oContent.style.backgroundColor="black",_this.element=m_oContent,buildPlayer()}function THEOWrapper(){var m_cAppendAdditionalParams,m_bTrackRequest,m_iTrackRequestCount,m_iTrackRequestMax,m_iTotalSegmentCount,m_iLastSegmentLoadTime,m_iLastSegmentLength,m_iTotalByteCount,m_iBufferStart,m_iTotalBufferTime,m_oLastVideoQualityLevel,m_iAdaptationUpCount,m_iAdaptationDownCount,m_bLoadedMetaDataTriggered,m_bStopPending,m_cSourceURL,m_oPlayerConfiguration,m_oPlayer,m_oContent,m_oHLSManifestParser,_this=this,m_bPauseItDuringLoad=!1,m_bAudioOnlyState=!1,m_oManifestDetailsMap={},m_oSegmentTimeStart={},m_iMasterManifestVersion=1,m_iManifestProcessed=0,m_iRequestFilterTimeout=5e3,m_iManifestWindowKeepSegment=12,m_iTimeOffset=0;function onRequestFilter(oRequest){var cType=oRequest.type;if("manifest"==cType){var cURL=oRequest.url;m_cAppendAdditionalParams&&cURL.indexOf(m_cAppendAdditionalParams)<0&&(cURL.indexOf("?")>-1?cURL+="&"+m_cAppendAdditionalParams:cURL+="?"+m_cAppendAdditionalParams),oRequest.waitUntil(function(fnDone){!function(cURL,oRequest,fnDone){fileRequestToType(cURL,"GET","text",oRequest.headers,oRequest.body,{onabort:onRequestFilterFail.bind({request:oRequest,done:fnDone}),onerror:onRequestFilterFail.bind({request:oRequest,done:fnDone}),onload:function(oEvent,oResponse){var iSegmentCount=_this.windowManifest?m_iManifestWindowKeepSegment:-1,oResults=m_oHLSManifestParser.parsePlaylist(oResponse.data,oResponse.uri,iSegmentCount);if(1==oResults.type){if(oResults.live&&oResults.segments&&oResults.segments.length&&oResults.segments[0].tags.length){var aResult=oResults.segments[0].absoluteUri.match(amp.HLSSegmentNumberRegex);aResult&&3==aResult.length&&(oResults.mediaSequence=parseInt(aResult[2])),m_iTimeOffset||(m_iTimeOffset=3*oResults.targetDuration,function(oRequest,fnDone,oResults,oSegment){fileRequestToType(oSegment.absoluteUri,"GET","arraybuffer",null,null,{onabort:function(){fnDone(0)},onerror:function(){fnDone(0)},onload:function(oEvent,oResponse){var cMimeType=oResponse.headers["content-type"];if(cMimeType&&(cMimeType=cMimeType.toLowerCase()),"video/mp4"==cMimeType||"audio/mp4"==cMimeType){if(!oResults.map.URI)throw new Error("missing init.mp4");var iIndex=oSegment.absoluteUri.lastIndexOf("/"),cInitURI=oSegment.absoluteUri.substr(0,iIndex+1)+oResults.map.URI;fileRequestToType(cInitURI,"GET","arraybuffer",null,null,{onabort:function(){fnDone(0)},onerror:function(){fnDone(0)},onload:function(oEvent2,oResponse2){onRequestFilterExtractTimeFromData(oRequest,fnDone,oResults,cMimeType,oResponse.data,oResponse2.data)}})}else onRequestFilterExtractTimeFromData(oRequest,fnDone,oResults,cMimeType,oResponse.data)}})}(oRequest,function(iSeconds){m_iTimeOffset-=iSeconds},oResults,oResults.segments[0]));var cManifest=m_oHLSManifestParser.createManifestFrom(oResults,!1,_this.windowManifest);amp.debug==amp.DebugType.MANIFEST&&console.warn(cManifest),oRequest.respondWith({headers:oResponse.headers,body:cManifest,status:200,statusText:"OK"}),fnDone()}else oRequest.respondWith({headers:oResponse.headers,body:oResponse.data,status:200,statusText:"OK"}),fnDone();m_iManifestProcessed++}else m_iMasterManifestVersion=oResults.version,oRequest.respondWith({headers:oResponse.headers,body:oResponse.data,status:200,statusText:"OK"}),fnDone()}})}(cURL,oRequest,fnDone)},m_iRequestFilterTimeout)}else"segment"==cType&&(m_oSegmentTimeStart[oRequest.url]=(new Date).getTime(),m_bTrackRequest&&(oRequest.headers.Pragma="akamai-x-cache-on, akamai-x-cache-remote-on, akamai-x-get-nonces, akamai-x-get-ssl-client-session-id, akamai-x-serial-no, akamai-x-feo-trace, akamai-x-get-request-id",m_bTrackRequest=!1,oRequest.redirect({url:oRequest.url,method:oRequest.method,headers:oRequest.headers})))}function onRequestFilterFail(event){this.request.respondWith({body:"",status:404,statusText:"OK"}),this.done()}function onRequestFilterExtractTimeFromData(oRequest,fnDone,oResults,cMimeType,oData1,oData2){var iTime=0;"video/mp4"==cMimeType||"audio/mp4"==cMimeType?iTime=function(mediaData,initData){let timescale=0;if((new Mp4Parser).box("moov",Mp4Parser.children).box("trak",Mp4Parser.children).box("mdia",Mp4Parser.children).fullBox("mdhd",function(box){box.reader.skip(0==box.version?8:16),timescale=box.reader.readUint32(),box.parser.stop()}).parse(initData,!0),!timescale)throw new Error("unable to find timescale in init segment");let startTime=0,parsedMedia=!1;if((new Mp4Parser).box("moof",Mp4Parser.children).box("traf",Mp4Parser.children).fullBox("tfdt",function(box){let baseTime=0==box.version?box.reader.readUint32():box.reader.readUint64();startTime=baseTime/timescale,parsedMedia=!0,box.parser.stop()}).parse(mediaData,!0),!parsedMedia)throw new Error("cannot parse segment start time");return startTime}(oData1,oData2):"audio/mpeg"==cMimeType?iTime=0:"video/mp2t"==cMimeType&&(iTime=function(data){let reader=new DataViewReader(new DataView(data),Endianness.BIG_ENDIAN),packetStart=0,syncByte=0;const skipPacket=function(){reader.seek(packetStart+188),71!=(syncByte=reader.readUint8())&&(reader.seek(packetStart+192),syncByte=reader.readUint8()),71!=syncByte&&(reader.seek(packetStart+204),syncByte=reader.readUint8()),reader.rewind(1)};for(;;){if(packetStart=reader.getPosition(),71!=(syncByte=reader.readUint8()))throw new Error("missing sync byte");let flagsAndPacketId=reader.readUint16(),hasPesPacket=16384&flagsAndPacketId;if(!hasPesPacket)throw new Error("missing pes packet");let flags=reader.readUint8(),adaptationFieldControl=(48&flags)>>4;if(0==adaptationFieldControl||2==adaptationFieldControl)throw new Error("adaptation field control error");if(3==adaptationFieldControl){let length=reader.readUint8();reader.skip(length)}let startCode=reader.readUint32(),startCodePrefix=startCode>>8;if(1!=startCodePrefix){skipPacket();continue}reader.skip(3);let ptsDtsIndicator=reader.readUint8()>>6;if(0==ptsDtsIndicator||1==ptsDtsIndicator)throw new Error("pts dts indicator missing");let pesHeaderLengthRemaining=reader.readUint8();if(0==pesHeaderLengthRemaining)throw new Error("pes header exhausted");let pts0=reader.readUint8(),pts1=reader.readUint16(),pts2=reader.readUint16(),ptsHigh3=(14&pts0)>>1,ptsLow30=(65534&pts1)<<14|(65534&pts2)>>1,pts=ptsHigh3*(1<<30)+ptsLow30;return pts/TS_TIMESCALE_}return 0}(oData1)),fnDone(iTime)}function onResponseFilter(oResponse){var cType=oResponse.request.type;if("segment"==cType){var iStartTime=m_oSegmentTimeStart[oResponse.url];iStartTime&&(m_iLastSegmentLoadTime=(new Date).getTime()-iStartTime,delete m_oSegmentTimeStart[oResponse.url])}if(oResponse.status>=200&&oResponse.status<300){var oInfo;if("manifest"==cType){if(0==(oResults=m_oHLSManifestParser.parsePlaylist(oResponse.body,oResponse.url,6)).type)for(var oTag,iLup=0;iLup<oResults.tags.length;iLup++)"EXT-X-MEDIA"!=(oTag=oResults.tags[iLup]).name.toUpperCase()&&"EXT-X-STREAM-INF"!=oTag.name.toUpperCase()||(oInfo=extractDetailsFromMediaTag(oTag,oResponse.url)).type&&oInfo.url&&(m_oManifestDetailsMap[oInfo.url.toLowerCase()]=oInfo);else if(1==oResults.type){var cHash=oResponse.url.toLowerCase();(oInfo=m_oManifestDetailsMap[cHash])&&(oInfo.segments=oResults.segments,(oResults=oResults.segments[oResults.segments.length-1].absoluteUri.match(/(.*\/[^\/]*)(\d{5})\./))&&3==oResults.length&&(cHash=oResults[1],m_oManifestDetailsMap[cHash]=oInfo))}}else if("segment"==cType&&m_oPlayer.duration==1/0){var oResults;if((oResults=oResponse.url.match(/(.*\/[^\/]*)(\d{5})\./))&&3==oResults.length){cHash=oResults[1];if(oInfo=m_oManifestDetailsMap[cHash]){var oSegment;for(iLup=0;iLup<oInfo.segments.length;iLup++)if((oSegment=oInfo.segments[iLup]).absoluteUri==oResponse.url){m_iLastSegmentLength=1e3*oSegment.getTime();break}}}m_iTotalSegmentCount++;var oHeaders=oResponse.headers;oHeaders&&oHeaders["x-akamai-request-id"]&&(oInfo?(++m_iTrackRequestCount<m_iTrackRequestMax&&setTimeout(function(){m_bTrackRequest=!0},750*m_iTrackRequestCount),oInfo.type==amp.SegmentType.VIDEO?oHeaders.Stream=0:oInfo.type==amp.SegmentType.AUDIO&&(oHeaders.Stream=1),oHeaders.Segment=oInfo.segment,oHeaders.type=AXIOM_MEDIA_PLAYER_CUSTOM_HEADERS,onEvent(oHeaders)):m_bTrackRequest=!0)}oResponse.body&&(oResponse.body.byteLength?m_iTotalByteCount+=Math.round(oResponse.body.byteLength):oResponse.body.length&&(m_iTotalByteCount+=Math.round(oResponse.body.length)))}}function onEvent(oEvent){var oCustom;for(var cKey in"function"==typeof CustomEvent?oCustom=new CustomEvent(oEvent.type):(oCustom=document.createEvent("CustomEvent")).initCustomEvent(oEvent.type,!0,!1,oEvent),oEvent)void 0==oCustom[cKey]&&(oCustom[cKey]=oEvent[cKey]);_this.element.dispatchEvent(oCustom)}function onSourceChangeEvent(oEvent){m_bLoadedMetaDataTriggered||_this.play()}function onLoadedMetaDataEvent(oEvent){m_oContent.style.visibility="",m_bLoadedMetaDataTriggered||(m_bLoadedMetaDataTriggered=!0,onEvent(oEvent))}function onLoadedDataEvent(oEvent){var iTrack;for(m_bPauseItDuringLoad&&(m_bPauseItDuringLoad=!1,_this.pause()),m_bLoadedMetaDataTriggered||(m_bLoadedMetaDataTriggered=!0,onEvent({type:"loadedmetadata"})),iTrack=0;iTrack<m_oPlayer.videoTracks.length;iTrack++)m_oPlayer.videoTracks[iTrack].addEventListener("activequalitychanged",onVideoActiveQualityChange);m_oContent.style.visibility="",onEvent(oEvent)}function onVideoActiveQualityChange(oEvent){m_oLastVideoQualityLevel&&(m_oLastVideoQualityLevel.averageBandwidth<oEvent.quality.averageBandwidth?m_iAdaptationUpCount++:m_iAdaptationDownCount++),m_oLastVideoQualityLevel=oEvent.quality,oEvent.type="adaptation",onEvent(oEvent)}function onReadyStateChangeEvent(oEvent){if(oEvent.readyState>2){var iBufferingTime=0;m_iBufferStart&&(iBufferingTime=Date.now()-m_iBufferStart,m_iTotalBufferTime+=iBufferingTime,m_iBufferStart=0),onEvent({type:"buffering",buffering:!1,bufferingTime:iBufferingTime})}else m_iBufferStart||(m_iBufferStart=Date.now()),onEvent({type:"buffering",buffering:!0})}function getTextTrackIdentifier(){var iID=-1;if(m_oPlayer.textTracks)for(var aFullTracks=m_oPlayer.textTracks,iLup=0;iLup<aFullTracks.length;iLup++)if("showing"==aFullTracks[iLup].mode){iID=iLup;break}return iID}function extractDetailsFromMediaTag(oTag,cBaseURL){for(var oAttr,oReturn={},iLup=0;iLup<oTag.attributes.length;iLup++)"TYPE"==(oAttr=oTag.attributes[iLup]).name.toUpperCase()?"AUDIO"==oAttr.value.toUpperCase()&&(oReturn.type=amp.SegmentType.AUDIO):"BANDWIDTH"==oAttr.name.toUpperCase()?oReturn.bandwidth=parseInt(oAttr.value):"CODECS"==oAttr.name.toUpperCase()?oAttr.value.toUpperCase().indexOf("AVC")>-1?oReturn.type=amp.SegmentType.VIDEO:oReturn.type=amp.SegmentType.AUDIO:"URI"==oAttr.name.toUpperCase()&&(oReturn.url=getAbsoluteSegmentURL(cBaseURL,oAttr.value));return oReturn}function fileRequestToType(uri,method,requestType,headers,body,aoHandlers){var xhr=new XMLHttpRequest;if(xhr.open(method,uri,!0),xhr.responseType=requestType,xhr.onload=function(event){var target=event.target,headers=target.getAllResponseHeaders().trim().split("\r\n").reduce(function(all,part){var header=part.split(": ");return all[header[0].toLowerCase()]=header.slice(1).join(": "),all},{}),oResponse={uri:uri,data:target.response,headers:headers,fromCache:!!headers["x-shaka-from-cache"]};aoHandlers&&aoHandlers.onload&&aoHandlers.onload(event,oResponse)},aoHandlers&&(aoHandlers.onabort&&(xhr.onabort=aoHandlers.onabort),aoHandlers.onerror&&(xhr.onerror=aoHandlers.onerror),aoHandlers.ontimeout&&(xhr.ontimeout=aoHandlers.ontimeout)),headers)for(var key in headers){var lowercasedKey=key.toLowerCase();xhr.setRequestHeader(lowercasedKey,headers[key])}xhr.send(body)}this.loadSource=function(cSource,cContentType,oStreamingParameters){m_iManifestProcessed=0,m_iTimeOffset=0,m_bLoadedMetaDataTriggered=!1,m_oLastVideoQualityLevel=null,m_iAdaptationUpCount=0,m_iAdaptationDownCount=0,m_iBufferStart=0,m_iTotalBufferTime=0,m_iTotalSegmentCount=0,m_iLastSegmentLoadTime=0,m_iTotalByteCount=0;var oSource={src:m_cSourceURL=cSource};if(cContentType&&(oSource.type=cContentType),m_cAppendAdditionalParams=null,m_cSourceURL.indexOf("?")>0){var aResults=m_cSourceURL.split("?");aResults&&2==aResults.length&&(m_cAppendAdditionalParams=aResults[1])}m_oPlayer.source={sources:[oSource]}},this.startTrackingRequestsFor=function(iCount){m_bTrackRequest=!0,m_iTrackRequestCount=0,m_iTrackRequestMax=iCount},Object.defineProperty(this,"audioOnly",{get:function(){return m_bAudioOnlyState},set:function(val){m_bAudioOnlyState!=val&&(m_bAudioOnlyState=val)}}),Object.defineProperty(this,"autoplay",{get:function(){return m_oPlayer.autoplay},set:function(val){m_oPlayer.autoplay=val}}),Object.defineProperty(this,"autoBitrate",{get:function(){return!(!m_oPlayer.abr||"bandwidth"!=m_oPlayer.abr.strategy.type)}}),Object.defineProperty(this,"currentTime",{get:function(){return m_oPlayer.currentTime-m_iTimeOffset},set:function(val){m_oPlayer.currentTime=val}}),Object.defineProperty(this,"duration",{get:function(){return m_oPlayer.duration}}),Object.defineProperty(this,"loop",{get:function(){return m_oPlayer.loop},set:function(val){m_oPlayer.loop=val}}),Object.defineProperty(this,"muted",{get:function(){return m_oPlayer.muted},set:function(val){m_oPlayer.muted=val}}),Object.defineProperty(this,"paused",{get:function(){return m_oPlayer.paused},set:function(val){m_oPlayer.paused=val}}),Object.defineProperty(this,"currentQualityLevelId",{get:function(){return function(){var iLevel=-1;if(m_oPlayer.videoTracks&&m_oPlayer.videoTracks.length)for(var oTrack,iTrack=0;iTrack<m_oPlayer.videoTracks.length;iTrack++)if((oTrack=m_oPlayer.videoTracks[iTrack]).enabled&&oTrack.activeQuality){iLevel=oTrack.activeQuality.id;break}return iLevel}()},set:function(val){!function(cID){if(m_oPlayer.videoTracks&&m_oPlayer.videoTracks.length)for(var oTrack,oQuality,iTrack=0;iTrack<m_oPlayer.videoTracks.length;iTrack++)if(oTrack=m_oPlayer.videoTracks[iTrack],-1==cID)oTrack.targetQuality=null;else for(var iLup=0;iLup<oTrack.qualities.length;iLup++)if((oQuality=oTrack.qualities[iLup]).id==cID)return void(oTrack.targetQuality=oQuality)}(val)}}),Object.defineProperty(this,"qualityLevels",{get:function(){return function(){var aTracks=[];if(m_oPlayer.videoTracks&&m_oPlayer.videoTracks.length){for(var oTrack,oQuality,iTrack=0;iTrack<m_oPlayer.videoTracks.length;iTrack++){oTrack=m_oPlayer.videoTracks[iTrack];for(var iLup=0;iLup<oTrack.qualities.length;iLup++)oQuality=oTrack.qualities[iLup],aTracks.push({bitrate:oQuality.bandwidth,qualityIndex:oQuality.id})}aTracks&&aTracks.length>1&&aTracks.sort(function(oFirst,oSecond){return(oFirst?oFirst.bitrate:0)-(oSecond?oSecond.bitrate:0)})}return aTracks}()}}),Object.defineProperty(this,"src",{get:function(){return m_cSourceURL}}),Object.defineProperty(this,"stopPending",{get:function(){return m_bStopPending},set:function(val){m_bStopPending=val}}),Object.defineProperty(this,"textTrackVisible",{get:function(){return getTextTrackIdentifier()>-1},set:function(val){!function(bShow){if(m_oPlayer.textTracks){var aFullTracks=m_oPlayer.textTracks;if(bShow)aFullTracks.length&&(aFullTracks[0].mode="showing");else{aFullTracks=m_oPlayer.textTracks;for(var iLup=0;iLup<aFullTracks.length;iLup++)oTrack=aFullTracks[iLup],oTrack.mode="hidden"}}}(val)}}),Object.defineProperty(this,"currentTextTrackId",{get:function(){return getTextTrackIdentifier()},set:function(val){!function(cID){if(m_oPlayer.textTracks)for(var aFullTracks=m_oPlayer.textTracks,iIndex=parseInt(cID),iLup=0;iLup<aFullTracks.length;iLup++)aFullTracks[iLup].mode=iLup==iIndex?"showing":"hidden"}(val)}}),Object.defineProperty(this,"textTracks",{get:function(){return function(){var oTrack,aTracks=[];if(m_oPlayer.textTracks)for(var aFullTracks=m_oPlayer.textTracks,iLup=0;iLup<aFullTracks.length;iLup++)oTrack=aFullTracks[iLup],aTracks.push({id:iLup,title:oTrack.label,language:oTrack.language});return aTracks}()}}),Object.defineProperty(this,"volume",{get:function(){return m_oPlayer.volume},set:function(val){m_oPlayer.volume=val}}),Object.defineProperty(this,"windowManifest",{get:function(){return m_iMasterManifestVersion<6?m_iManifestProcessed>=1:m_iManifestProcessed>=2}}),this.addEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.addEventListener(cEventType,fnFunction,bUseCapture)},this.removeEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.removeEventListener(cEventType,fnFunction,bUseCapture)},this.destroy=function(){m_oPlayer&&m_oPlayer.destroy&&m_oPlayer.destroy()},this.getPlayerObject=function(){return m_oPlayer},this.getMediaObject=function(){return null},this.getStats=function(){var oReturn={},iTotalBufferTime=m_iTotalBufferTime;return m_iBufferStart&&(iTotalBufferTime+=(new Date).getTime()-m_iBufferStart),oReturn.bufferingTime=iTotalBufferTime,oReturn.lastSegmentLoadTime=m_iLastSegmentLoadTime,oReturn.lastSegmentLength=m_iLastSegmentLength,oReturn.totalByteCount=m_iTotalByteCount,oReturn.totalSegmentCount=m_iTotalSegmentCount,oReturn.adaptationUpCount=m_iAdaptationUpCount,oReturn.adaptationDownCount=m_iAdaptationDownCount,oReturn.audioOnlyAdapataionCount=0,oReturn},this.pause=function(){m_oPlayer.pause()},this.play=function(){m_oPlayer.play()},this.unload=function(){m_oPlayer.source=null};var TS_TIMESCALE_=9e4,Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:1};function DataViewReader(dataView,endianness){this.dataView_=dataView,this.littleEndian_=endianness==Endianness.LITTLE_ENDIAN,this.position_=0}function Mp4Parser(){this.headers_=[],this.boxDefinitions_=[],this.done_=!1}DataViewReader.prototype.hasMoreData=function(){return this.position_<this.dataView_.byteLength},DataViewReader.prototype.getPosition=function(){return this.position_},DataViewReader.prototype.getLength=function(){return this.dataView_.byteLength},DataViewReader.prototype.readUint8=function(){try{let value=this.dataView_.getUint8(this.position_);return this.position_+=1,value}catch(exception){this.throwOutOfBounds_()}},DataViewReader.prototype.readUint16=function(){try{let value=this.dataView_.getUint16(this.position_,this.littleEndian_);return this.position_+=2,value}catch(exception){this.throwOutOfBounds_()}},DataViewReader.prototype.readUint32=function(){try{let value=this.dataView_.getUint32(this.position_,this.littleEndian_);return this.position_+=4,value}catch(exception){this.throwOutOfBounds_()}},DataViewReader.prototype.readInt32=function(){try{let value=this.dataView_.getInt32(this.position_,this.littleEndian_);return this.position_+=4,value}catch(exception){this.throwOutOfBounds_()}},DataViewReader.prototype.readUint64=function(){let low,high;try{this.littleEndian_?(low=this.dataView_.getUint32(this.position_,!0),high=this.dataView_.getUint32(this.position_+4,!0)):(high=this.dataView_.getUint32(this.position_,!1),low=this.dataView_.getUint32(this.position_+4,!1))}catch(exception){this.throwOutOfBounds_()}if(high>2097151)throw new Error("integer overflow");return this.position_+=8,high*Math.pow(2,32)+low},DataViewReader.prototype.readBytes=function(bytes){this.position_+bytes>this.dataView_.byteLength&&this.throwOutOfBounds_();let value=new Uint8Array(this.dataView_.buffer,this.dataView_.byteOffset+this.position_,bytes);return this.position_+=bytes,new Uint8Array(value)},DataViewReader.prototype.skip=function(bytes){this.position_+bytes>this.dataView_.byteLength&&this.throwOutOfBounds_(),this.position_+=bytes},DataViewReader.prototype.rewind=function(bytes){this.position_<bytes&&this.throwOutOfBounds_(),this.position_-=bytes},DataViewReader.prototype.seek=function(position){(position<0||position>this.dataView_.byteLength)&&this.throwOutOfBounds_(),this.position_=position},DataViewReader.prototype.readTerminatedString=function(){let start=this.position_;for(;this.hasMoreData();){if(0==this.dataView_.getUint8(this.position_))break;this.position_+=1}let ret=new Uint8Array(this.dataView_.buffer,this.dataView_.byteOffset+start,this.position_-start);return this.position_+=1,shaka.util.StringUtils.fromUTF8(ret)},DataViewReader.prototype.throwOutOfBounds_=function(){throw new Error("out of bounds")};var BoxType__BASIC_BOX=0,BoxType__FULL_BOX=1;Mp4Parser.prototype.box=function(type,definition){let typeCode=Mp4Parser.typeFromString_(type);return this.headers_[typeCode]=BoxType__BASIC_BOX,this.boxDefinitions_[typeCode]=definition,this},Mp4Parser.prototype.fullBox=function(type,definition){let typeCode=Mp4Parser.typeFromString_(type);return this.headers_[typeCode]=BoxType__FULL_BOX,this.boxDefinitions_[typeCode]=definition,this},Mp4Parser.prototype.stop=function(){this.done_=!0},Mp4Parser.prototype.parse=function(data,opt_partialOkay){let wrapped=new Uint8Array(data),reader=new DataViewReader(new DataView(wrapped.buffer,wrapped.byteOffset,wrapped.byteLength),Endianness.BIG_ENDIAN);for(this.done_=!1;reader.hasMoreData()&&!this.done_;)this.parseNext(0,reader,opt_partialOkay)},Mp4Parser.prototype.parseNext=function(absStart,reader,opt_partialOkay){let start=reader.getPosition(),size=reader.readUint32(),type=reader.readUint32();Mp4Parser.typeToString(type);switch(size){case 0:size=reader.getLength()-start;break;case 1:size=reader.readUint64()}let boxDefinition=this.boxDefinitions_[type];if(boxDefinition){let version=null,flags=null;if(this.headers_[type]==BoxType__FULL_BOX){let versionAndFlags=reader.readUint32();version=versionAndFlags>>>24,flags=16777215&versionAndFlags}let end=start+size;opt_partialOkay&&end>reader.getLength()&&(end=reader.getLength());let payloadSize=end-reader.getPosition(),payload=payloadSize>0?reader.readBytes(payloadSize):new Uint8Array(0),payloadReader=new DataViewReader(new DataView(payload.buffer,payload.byteOffset,payload.byteLength),Endianness.BIG_ENDIAN);boxDefinition({parser:this,partialOkay:opt_partialOkay||!1,version:version,flags:flags,reader:payloadReader,size:size,start:start+absStart})}else{const skipLength=Math.min(start+size-reader.getPosition(),reader.getLength()-reader.getPosition());reader.skip(skipLength)}},Mp4Parser.children=function(box){for(;box.reader.hasMoreData()&&!box.parser.done_;)box.parser.parseNext(box.start,box.reader,box.partialOkay)},Mp4Parser.sampleDescription=function(box){for(let count=box.reader.readUint32();count>0&&!box.parser.done_;count-=1)box.parser.parseNext(box.start,box.reader,box.partialOkay)},Mp4Parser.allData=function(callback){return function(box){let all=box.reader.getLength()-box.reader.getPosition();callback(box.reader.readBytes(all))}},Mp4Parser.typeFromString_=function(name){let code=0;for(let i=0;i<name.length;i++)code=code<<8|name.charCodeAt(i);return code},Mp4Parser.typeToString=function(type){return String.fromCharCode(type>>24&255,type>>16&255,type>>8&255,255&type)},m_oHLSManifestParser=new HLSManifestParser,(m_oContent=document.createElement("div")).className="theoplayer-container video-js theoplayer-skin",m_oContent.style.width="100%",m_oContent.style.height="100%",m_oContent.style.backgroundColor="black",_this.element=m_oContent,m_oPlayerConfiguration={libraryLocation:g_oSettings.ScriptDir+"/ThirdParty/THEOplayer/2.57.0/"},(m_oPlayer=new THEOplayer.Player(m_oContent,m_oPlayerConfiguration)).addEventListener("canplay",onEvent),m_oPlayer.addEventListener("canplaythrough",onEvent),m_oPlayer.addEventListener("durationchange",onEvent),m_oPlayer.addEventListener("ended",onEvent),m_oPlayer.addEventListener("error",onEvent),m_oPlayer.addEventListener("loadeddata",onLoadedDataEvent),m_oPlayer.addEventListener("loadedmetadata",onLoadedMetaDataEvent),m_oPlayer.addEventListener("pause",onEvent),m_oPlayer.addEventListener("play",onEvent),m_oPlayer.addEventListener("playing",onEvent),m_oPlayer.addEventListener("readystatechange",onReadyStateChangeEvent),m_oPlayer.addEventListener("seeked",onEvent),m_oPlayer.addEventListener("seeking",onEvent),m_oPlayer.addEventListener("sourcechange",onSourceChangeEvent),m_oPlayer.addEventListener("timeupdate",onEvent),m_oPlayer.addEventListener("volumechange",onEvent),m_oPlayer.addEventListener("waiting",onEvent),m_oPlayer.network.addRequestInterceptor(onRequestFilter),m_oPlayer.network.addResponseInterceptor(onResponseFilter)}function WebRTCWrapper(){var m_oMedia,m_oWebRTC,m_oContent,m_oParams,m_oSettings,oMedia,_this=this,m_bAudioOnlyState=!1;function onEvent(oEvent){var oCustom;for(var cKey in"function"==typeof CustomEvent?oCustom=new CustomEvent(oEvent.type):(oCustom=document.createEvent("CustomEvent")).initCustomEvent(oEvent.type,!0,!1,oEvent),oEvent)void 0==oCustom[cKey]&&(oCustom[cKey]=oEvent[cKey]);_this.element.dispatchEvent(oCustom)}function onStateUpdate(cState,oData){onEvent({type:AXIOM_MEDIA_PLAYER_RTC_UPDATE,state:cState,data:oData})}this.loadSource=function(oParams,oSettings){m_oSettings=oSettings,(m_oParams=oParams).StateUpdateCall=onStateUpdate,m_oParams.VideoDisplay=m_oMedia,m_oWebRTC=new AxiomWebRTC(m_oParams,m_oSettings)},Object.defineProperty(this,"audioOnly",{get:function(){return m_bAudioOnlyState},set:function(val){m_bAudioOnlyState!=val&&(m_bAudioOnlyState=val,m_oPlayer&&(_this.reload(),onEvent({type:AXIOM_MEDIA_PLAYER_AV_SWITCH,hasVideo:!m_bAudioOnlyState})))}}),Object.defineProperty(this,"autoplay",{get:function(){return m_oMedia.autoplay},set:function(val){m_oMedia.autoplay=val}}),Object.defineProperty(this,"autoBitrate",{get:function(){return!1}}),Object.defineProperty(this,"currentTime",{get:function(){return m_oMedia.currentTime},set:function(val){m_oMedia.currentTime=val}}),Object.defineProperty(this,"duration",{get:function(){return m_oMedia.duration}}),Object.defineProperty(this,"loop",{get:function(){return m_oMedia.loop},set:function(val){m_oMedia.loop=val}}),Object.defineProperty(this,"muted",{get:function(){return m_oMedia.muted},set:function(val){m_oMedia.muted=val}}),Object.defineProperty(this,"paused",{get:function(){return m_oMedia.paused},set:function(val){m_oMedia.paused=val}}),Object.defineProperty(this,"volume",{get:function(){return m_oMedia.volume},set:function(val){m_oMedia.volume=val}}),Object.defineProperty(this,"webrtc",{get:function(){return m_oWebRTC}}),this.addEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.addEventListener(cEventType,fnFunction,bUseCapture)},this.removeEventListener=function(cEventType,fnFunction,bUseCapture){_this.element.removeEventListener(cEventType,fnFunction,bUseCapture)},this.destroy=function(){m_oWebRTC&&m_oWebRTC.close&&m_oWebRTC.close(),m_oWebRTC=null},this.getPlayerObject=function(){return m_oMedia},this.getMediaObject=function(){return m_oMedia},this.pause=function(){m_oMedia.pause()},this.play=function(){m_oMedia.play()},this.reload=function(){onEvent({type:AXIOM_MEDIA_PLAYER_REBUILDING}),buildPlayer(),m_oParams&&_this.loadSource(m_oParams,m_oSettings)},this.terminate=function(){m_oWebRTC&&m_oWebRTC._terminate&&m_oWebRTC._terminate()},this.unload=function(){m_oWebRTC&&m_oWebRTC._resetStream&&m_oWebRTC._resetStream()},(m_oContent=document.createElement("div")).style.width="100%",m_oContent.style.height="100%",m_oContent.style.backgroundColor="black",_this.element=m_oContent,(oMedia=document.createElement(m_bAudioOnlyState?"audio":"video")).style.width="100%",oMedia.style.height="100%",oMedia.setAttribute("autoplay",!0),oMedia.addEventListener("contextmenu",function(event){return event.preventDefault(),!1}),IsIOS()&&(oMedia.setAttribute("preload","metadata"),oMedia.setAttribute("playsinline",!0),oMedia.setAttribute("webkit-playsinline",!0)),oMedia.addEventListener("canplay",onEvent),oMedia.addEventListener("durationchange",onEvent),oMedia.addEventListener("ended",onEvent),oMedia.addEventListener("error",onEvent),oMedia.addEventListener("loadeddata",onEvent),oMedia.addEventListener("loadedmetadata",onEvent),oMedia.addEventListener("pause",onEvent),oMedia.addEventListener("play",onEvent),oMedia.addEventListener("playing",onEvent),oMedia.addEventListener("seeked",onEvent),oMedia.addEventListener("timeupdate",onEvent),oMedia.addEventListener("volumechange",onEvent),oMedia.addEventListener("webkitendfullscreen",onEvent),m_oMedia=oMedia,m_oContent.appendChild(m_oMedia)}function HLSManifestParser(){function fromUTF8(data){if(!data)return"";var uint8=new Uint8Array(data);239==uint8[0]&&187==uint8[1]&&191==uint8[2]&&(uint8=uint8.subarray(3));var utf8=function(array){for(var subArray,ret="",i=0;i<array.length;i+=16e3)subArray=array.subarray(i,i+16e3),ret+=String.fromCharCode.apply(null,subArray);return ret}(uint8),escaped=escape(utf8);return decodeURIComponent(escaped)}function toUTF8(str){for(var encoded=encodeURIComponent(str),utf8=unescape(encoded),result=new Uint8Array(utf8.length),i=0;i<utf8.length;++i)result[i]=utf8.charCodeAt(i);return result.buffer}function isHLSComment(line){return/^#(?!EXT)/m.test(line)}function parseHLSSegment(absoluteMediaPlaylistUri,lines,playlistTags,oAdditionalData){for(var tag,line,segment,iValue,id=0,segments=[],segmentTags=[],aKnownTags=["EXT-X-TARGETDURATION","EXT-X-MEDIA-SEQUENCE","EXT-X-DISCONTINUITY-SEQUENCE","EXT-X-PLAYLIST-TYPE","EXT-X-MAP","EXT-X-I-FRAMES-ONLY","EXT-X-ENDLIST"],iLup=0;iLup<lines.length;iLup++)if(line=lines[iLup],/^(#EXT)/.test(line))tag=parseHLSTag(id++,line),aKnownTags.indexOf(tag.name)>=0?playlistTags.push(tag):(oAdditionalData&&"EXTINF"==tag.name&&(iValue=Math.ceil(parseFloat(tag.value)),oAdditionalData.targetDuration<iValue&&(oAdditionalData.targetDuration=iValue)),segmentTags.push(tag));else{if(isHLSComment(line))continue;segment=new HLSSegment(getAbsoluteSegmentURL(absoluteMediaPlaylistUri,line.trim()),segmentTags),segments.push(segment),segmentTags=[]}return segments}function getAbsoluteSegmentURL(cManifestURL,cSegmentURL){var cPath=null;if("/"==cSegmentURL.substring(0,1)){var iIndex=cManifestURL.indexOf("/",8);iIndex>0&&(cPath=cManifestURL.substring(0,iIndex)+cSegmentURL)}return cPath||(cPath=cSegmentURL.indexOf(":")>-1?cSegmentURL:(iIndex=cManifestURL.lastIndexOf("/"))>-1?cManifestURL.substr(0,iIndex+1)+cSegmentURL:cManifestURL="/"+cSegmentURL),cPath}function parseHLSTag(id,word){var blocks=word.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!blocks)return null;var name=blocks[1],data=blocks[2],attributes=[];if(data&&data.indexOf("=")>=0)for(var blockAttrs,attribute,parser=new TextParser(data),regex=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;blockAttrs=parser.readRegex(regex);)attribute=new HLSAttribute(blockAttrs[1],blockAttrs[2]||blockAttrs[3]),attributes.push(attribute);else if(data)return new HLSTag(id,name,attributes,data);return new HLSTag(id,name,attributes)}function HLSSegment(absoluteUri,tags){this.tags=tags,this.absoluteUri=absoluteUri}function HLSTag(id,name,attributes,opt_value){this.id=id,this.name=name,this.attributes=attributes,this.value=opt_value||null}function HLSAttribute(name,value){this.name=name,this.value=value}function TextParser(data){this.data_=data,this.position_=0}this.parsePlaylist=function(oData,absolutePlaylistUri,iMaxSegments){for(var iTargetDuration,cLine,oTag,MEDIA_PLAYLIST_TAGS=["EXT-X-TARGETDURATION","EXT-X-MEDIA-SEQUENCE","EXT-X-DISCONTINUITY-SEQUENCE","EXT-X-PLAYLIST-TYPE","EXT-X-MAP","EXT-X-I-FRAMES-ONLY","EXT-X-ENDLIST"],SEGMENT_TAGS=["EXTINF","EXT-X-BYTERANGE","EXT-X-DISCONTINUITY","EXT-X-PROGRAM-DATE-TIME","EXT-X-KEY","EXT-X-DATERANGE"],lines=(oData instanceof ArrayBuffer?fromUTF8(oData):oData).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim().split(/\n+/m),iPlaylistType=0,iVersion=1,iMediaSequence=0,bAllowCache=!1,oMap={},bLive=!0,iID=0,iLup=1;iLup<lines.length;iLup++)if(!isHLSComment(cLine=lines[iLup])){if(oTag=parseHLSTag(iID++,cLine),MEDIA_PLAYLIST_TAGS.indexOf(oTag.name)>=0){iPlaylistType=1;break}"EXT-X-STREAM-INF"==oTag.name&&(iLup+=1)}iID=0;var iLines,oAdditionalData,segmentsData,segments,aoTags=[];for(iLup=1;iLup<lines.length;)if(isHLSComment(lines[iLup]))iLup++;else{if(oTag=parseHLSTag(iID++,lines[iLup]),SEGMENT_TAGS.indexOf(oTag.name)>-1){if(1!=iPlaylistType)continue;return iMaxSegments>0?(iLines=2*iMaxSegments,segmentsData=lines.splice(Math.max(iLup,lines.length-iLines),iLines)):segmentsData=lines.splice(iLup,lines.length-iLup),segments=parseHLSSegment(absolutePlaylistUri,segmentsData,aoTags,oAdditionalData={targetDuration:iTargetDuration}),segmentsData.length>0&&segmentsData[segmentsData.length-1].indexOf("#EXT-X-ENDLIST")>-1&&(bLive=!1),{type:iPlaylistType,segments:segments,url:absolutePlaylistUri,targetDuration:oAdditionalData.targetDuration,version:iVersion,mediaSequence:iMediaSequence,allowCache:bAllowCache,live:bLive,map:oMap}}if("EXT-X-TARGETDURATION"==oTag.name)iTargetDuration=parseInt(oTag.value);else if("EXT-X-VERSION"==oTag.name)iVersion=parseInt(oTag.value);else if("EXT-X-ALLOW-CACHE"==oTag.name)bAllowCache="NO"!=oTag.value;else if("EXT-X-MEDIA-SEQUENCE"==oTag.name)iMediaSequence=parseInt(oTag.value);else if("EXT-X-ENDLIST"==oTag.name)bLive=!1;else if("EXT-X-MAP"==oTag.name){var oAttribute;for(var cKey in oTag.attributes)oMap[(oAttribute=oTag.attributes[cKey]).name]=oAttribute.value}if(aoTags.push(oTag),iLup++,"EXT-X-STREAM-INF"==oTag.name){var tagUri=new HLSAttribute("URI",lines[iLup]);oTag.addAttribute(tagUri),iLup++}}return{type:iPlaylistType,tags:aoTags,url:absolutePlaylistUri,version:iVersion}},this.createManifestFrom=function(oResults,bUIntArray,bAppendDiscontinuity){var cManifest="#EXTM3U\n";if(cManifest+="#EXT-X-VERSION:"+oResults.version+"\n",cManifest+="#EXT-X-ALLOW-CACHE:"+(oResults.allowCache?"YES":"NO")+"\n",oResults.mediaSequence>-1&&(cManifest+="#EXT-X-MEDIA-SEQUENCE:"+oResults.mediaSequence+"\n"),cManifest+="#EXT-X-TARGETDURATION:"+oResults.targetDuration+"\n",oResults.map){var cMap="";for(var cKey in oResults.map)cMap+=cKey+'="'+oResults.map[cKey]+(cMap.length?'",':'"');cMap&&(cManifest+="#EXT-X-MAP:"+cMap+"\n")}if(bAppendDiscontinuity&&(cManifest+="#EXT-X-DISCONTINUITY\n"),oResults.segments)for(var oSegment,oTags,iLup=0;iLup<oResults.segments.length;iLup++){oSegment=oResults.segments[iLup];for(var iLup2=0;iLup2<oSegment.tags.length;iLup2++)cManifest+="#"+(oTags=oSegment.tags[iLup2]).name+":"+oTags.value+"\n";cManifest+=oSegment.absoluteUri+"\n"}return bUIntArray?toUTF8(cManifest):cManifest},this.arrayBufferToText=function(arrayBuffer){return fromUTF8(arrayBuffer)},this.textToArrayBuffer=function(cText){return toUTF8(cText)},HLSSegment.prototype.getTime=function(attribute){for(var oTag,fTime=0,iLup=0;iLup<this.tags.length;iLup++)if("EXTINF"==(oTag=this.tags[iLup]).name.toUpperCase()){fTime=parseFloat(oTag.value);break}return fTime},HLSTag.prototype.addAttribute=function(attribute){this.attributes.push(attribute)},TextParser.prototype.atEnd=function(){return this.position_==this.data_.length},TextParser.prototype.readLine=function(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)},TextParser.prototype.readWord=function(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)},TextParser.prototype.skipWhitespace=function(){this.readRegex(/[ \t]+/gm)},TextParser.prototype.readRegex=function(regex){var index=this.indexOf_(regex);return this.atEnd()||null==index||index.position!=this.position_?null:(this.position_+=index.length,index.results)},TextParser.prototype.readRegexReturnCapture_=function(regex,index){if(this.atEnd())return null;var ret=this.readRegex(regex);return ret?ret[index]:null},TextParser.prototype.indexOf_=function(regex){regex.lastIndex=this.position_;var results=regex.exec(this.data_);return null==results?null:{position:results.index,length:results[0].length,results:results}}}amp.PlayerType={NATIVE:1,SHAKA:2,THEO:3},amp.SegmentType={UNKNOWN:0,VIDEO:1,AUDIO:2,SUBTITLE:3},amp.HLSSegmentNumberRegex=/(.*[\/_-]+[^\/0-9]*)(\d+)\./,amp.DebugType={NONE:0,EVENTS:1,MANIFEST:2},AxiomMediaPlayer.prototype._onWindowUnload=function(){this.bIsLive||!this.m_bTrackView||this.m_bWindowUnloadSaved||(this.m_bWindowUnloadSaved=!0,this.SaveCurrentMediaViewTime())},AxiomMediaPlayer.prototype.processMediaPlayerRequirement=function(cURL,cContentType,fnOnComplete){return!1},AxiomMediaPlayer.prototype.setHandler=function(cCall,fnCallHandler){cCall&&fnCallHandler&&(this.m_oCallHandlers[cCall]||(this.m_oCallHandlers[cCall]=new Array),-1==this.m_oCallHandlers[cCall].indexOf(fnCallHandler)&&this.m_oCallHandlers[cCall].push(fnCallHandler))},AxiomMediaPlayer.prototype.removeHandler=function(cCall,fnCallHandler){if(cCall&&fnCallHandler){var iIndex=-1;this.m_oCallHandlers&&this.m_oCallHandlers[cCall]&&(iIndex=this.m_oCallHandlers[cCall].indexOf(fnCallHandler)),-1!=iIndex&&this.m_oCallHandlers[cCall].splice(iIndex,1)}},AxiomMediaPlayer.prototype.overrideMediaCheck=function(bOverride){},AxiomMediaPlayer.prototype.stopPending=function(){this.m_bPendingStop=!0,this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.stopPending=!0)},AxiomMediaPlayer.prototype.reload=function(){this.m_oPlayerWrapper&&this.m_oPlayerWrapper.reload()},AxiomMediaPlayer.prototype.setOutputParams=function(iOutputKey,iIACServerKey,cInternalIPAddress,cIACServerName){this.m_iOutputKey=iOutputKey,this.m_iIACServerKey=iIACServerKey&&!isNaN(iIACServerKey)?iIACServerKey:0,this.m_cInternalIPAddress=cInternalIPAddress&&cInternalIPAddress.length>0?cInternalIPAddress:"",this.m_cIACServerName=cIACServerName&&cIACServerName.length>0?cIACServerName:"",iIACServerKey&&iIACServerKey>0&&(this.CDNType=CDN_TYPE_AMPLIFY)},AxiomMediaPlayer.prototype.load=function(cURLPath,iOutputKey,iIACServerKey,cInternalIPAddress,cIACServerName){var _this=this;this.setOutputParams(iOutputKey,iIACServerKey,cInternalIPAddress,cIACServerName),this.loadSource(cURLPath,null,function(){_this.SendInfo()})},AxiomMediaPlayer.prototype.unload=function(bClearStats){this.m_oSrcToPlayerWrapperMap={},this.bLoaded=!1,this.m_oPlayerWrapper&&this.m_oPlayerWrapper.unload()},AxiomMediaPlayer.prototype.destroy=function(){this.unload(),this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.destroy(),this.m_oPlayerWrapper=null,this.m_oPlayer=null)},AxiomMediaPlayer.prototype.isPaused=function(){var bPaused=!0;return this.m_oPlayerWrapper&&(bPaused=this.m_oPlayerWrapper.paused),bPaused},AxiomMediaPlayer.prototype.setSize=function(iWidth,iHeight){},AxiomMediaPlayer.prototype.play=function(){this.m_oPlayerWrapper&&this.m_oPlayerWrapper.play()},AxiomMediaPlayer.prototype.pause=function(){this.m_oPlayerWrapper&&this.m_oPlayerWrapper.pause(),this.SaveCurrentMediaViewTime()},AxiomMediaPlayer.prototype.getDuration=function(){var iTime=0;return this.m_oPlayerWrapper&&(iTime=1e3*this.m_oPlayerWrapper.duration),iTime},AxiomMediaPlayer.prototype.getCurrentTime=function(){var iTime=0;return this.m_oPlayerWrapper&&(iTime=1e3*this.m_oPlayerWrapper.currentTime),iTime},AxiomMediaPlayer.prototype.seek=function(iTime,bDisablePauseCheck){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.currentTime=iTime/1e3)},AxiomMediaPlayer.prototype.getBuffer=function(){var iTime=0;this.m_oPlayerWrapper&&(iTime=this.m_oPlayerWrapper.getStats().bufferingTime);return iTime},AxiomMediaPlayer.prototype.isMuted=function(){var bMuted=!1;return this.m_oPlayerWrapper&&(bMuted=this.m_oPlayerWrapper.muted),bMuted},AxiomMediaPlayer.prototype.mute=function(){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.muted=!0)},AxiomMediaPlayer.prototype.unmute=function(){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.muted=!1)},AxiomMediaPlayer.prototype.getVolume=function(){var fVolume=0;return this.m_oPlayerWrapper&&(fVolume=this.m_oPlayerWrapper.volume),fVolume},AxiomMediaPlayer.prototype.setVolume=function(fValue){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.volume=fValue)},AxiomMediaPlayer.prototype.setAutoLoop=function(bAutoLoop){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.loop=bAutoLoop)},AxiomMediaPlayer.prototype.getCurrentQuality=function(){var cID=null;return this.m_oPlayerWrapper&&(cID=this.m_oPlayerWrapper.currentQualityLevelId),cID},AxiomMediaPlayer.prototype.getAutoQuality=function(){var bAuto=!1;return this.m_oPlayerWrapper&&(bAuto=this.m_oPlayerWrapper.autoBitrate),bAuto},AxiomMediaPlayer.prototype.setQuality=function(iLevel,bUserInitiated){this.m_oPlayerWrapper&&(this.m_bPendingUserInitiated=bUserInitiated&&-1!=iLevel,this.m_oPlayerWrapper.currentQualityLevelId=iLevel,this.m_bPendingUserInitiated&&this._dispatchEvent(AXIOM_MEDIA_PLAYER_QUALITY_SET,{Level:iLevel}))},AxiomMediaPlayer.prototype.getQualityLevels=function(){var aQualityLevels=null;return this.m_oPlayerWrapper&&(aQualityLevels=this.m_oPlayerWrapper.qualityLevels),aQualityLevels},AxiomMediaPlayer.prototype.getCurrentQualityLevel=function(){return{PendingQualityLevel:this.m_iPendingQualityLevel,PreviousQualityLevel:this.m_iPreviousQualityLevel,CurrentQualityLevel:this.m_iCurrentQualityLevel}},AxiomMediaPlayer.prototype.getCurrentQualityIndex=function(){var oQualityLevel=null;return this.m_oPlayerWrapper&&(oQualityLevel=this.getQualityByIndex(this.m_iCurrentQualityLevel)),oQualityLevel},AxiomMediaPlayer.prototype.getQualityByIndex=function(iQualityLevel){var iReturnIndex=-1;if(this.m_oPlayerWrapper){this.m_aTracks||(this.m_aTracks=this.getQualityLevels());for(var iLup=0;iLup<this.m_aTracks.length;iLup++)if(this.m_aTracks[iLup].qualityIndex==iQualityLevel){iReturnIndex=iLup;break}}return iReturnIndex},AxiomMediaPlayer.prototype.getTextTracks=function(){var aTracks=null;return this.m_oPlayerWrapper&&(aTracks=this.m_oPlayerWrapper.textTracks),aTracks},AxiomMediaPlayer.prototype.hasTextTracks=function(){var bHasOne=!1;if(this.m_oPlayerWrapper){var aTracks=this.m_oPlayerWrapper.textTracks;bHasOne=aTracks&&aTracks.length}return bHasOne},AxiomMediaPlayer.prototype.setTextTrackId=function(cID){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.currentTextTrackId=cID)},AxiomMediaPlayer.prototype.getCurrentTextTrackId=function(){var cID=null;return this.m_oPlayerWrapper&&(cID=this.m_oPlayerWrapper.currentTextTrackId),cID},AxiomMediaPlayer.prototype.isTextTrackVisible=function(){var bVisible=!1;return this.m_oPlayerWrapper&&(bVisible=this.m_oPlayerWrapper.textTrackVisible),bVisible},AxiomMediaPlayer.prototype.setTextTrackVisible=function(bShow){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.textTrackVisible=bShow)},AxiomMediaPlayer.prototype.startCustomHeaderCapture=function(iCount){this.m_oPlayerWrapper&&this.m_oPlayerWrapper.startTrackingRequestsFor&&this.m_oPlayerWrapper.startTrackingRequestsFor(5)},AxiomMediaPlayer.prototype._setMediaEventListeners=function(){this.m_oPlayerWrapper&&(this.m_oPlayerWrapper instanceof WebRTCWrapper&&this.m_oPlayerWrapper.addEventListener(AXIOM_MEDIA_PLAYER_RTC_UPDATE,this._onRTCStateUpdate.bind(this)),this.m_oEventDashBufferStateChange||(this.m_oEventDashBufferStateChange=this._onMediaBufferUpdate.bind(this)),this.m_oPlayerWrapper.addEventListener("buffering",this.m_oEventDashBufferStateChange),this.m_oEventDashMediaManifestLoaded||(this.m_oEventDashMediaManifestLoaded=this._onMediaManifestLoaded.bind(this)),this.m_oPlayerWrapper.addEventListener("streaming",this.m_oEventDashMediaManifestLoaded),this.m_oEventDashQualityRequest||(this.m_oEventDashQualityRequest=this._onMediaQualityChange.bind(this)),this.m_oPlayerWrapper.addEventListener("adaptation",this.m_oEventDashQualityRequest),this.m_oEventDashError||(this.m_oEventDashError=this._onMediaError.bind(this)),this.m_oPlayerWrapper.addEventListener("error",this.m_oEventDashError),this.m_oEventPlay||(this.m_oEventPlay=this._onMediaPlay.bind(this)),this.m_oPlayerWrapper.addEventListener("play",this.m_oEventPlay),this.m_oEventPause||(this.m_oEventPause=this._onMediaPause.bind(this)),this.m_oPlayerWrapper.addEventListener("pause",this.m_oEventPause),this.m_oEventMetaDataLoaded||(this.m_oEventMetaDataLoaded=this._onMediaMetaDataLoaded.bind(this)),this.m_oPlayerWrapper.addEventListener("loadedmetadata",this.m_oEventMetaDataLoaded),this.m_oEventDataLoaded||(this.m_oEventDataLoaded=this._onMediaDataLoaded.bind(this)),this.m_oPlayerWrapper.addEventListener("loadeddata",this.m_oEventDataLoaded),this.m_oEventVolumeChange||(this.m_oEventVolumeChange=this._onMediaVolumeChange.bind(this)),this.m_oPlayerWrapper.addEventListener("volumechange",this.m_oEventVolumeChange),this.m_oEventDurationChange||(this.m_oEventDurationChange=this._onMediaDurationChange.bind(this)),this.m_oPlayerWrapper.addEventListener("durationchange",this.m_oEventDurationChange),this.m_oEventTimeUpdate||(this.m_oEventTimeUpdate=this._onMediaTimeUpdate.bind(this)),this.m_oPlayerWrapper.addEventListener("timeupdate",this.m_oEventTimeUpdate),this.m_oEventWebkitExitFullscreen||(this.m_oEventWebkitExitFullscreen=this._onWebkitEndFullscreen.bind(this)),this.m_oPlayerWrapper.addEventListener("webkitendfullscreen",this.m_oEventWebkitExitFullscreen),this.m_oEventSeeked||(this.m_oEventSeeked=this._onMediaSeeked.bind(this)),this.m_oPlayerWrapper.addEventListener("seeked",this.m_oEventSeeked),this.m_oEventEnded||(this.m_oEventEnded=this._onMediaComplete.bind(this)),this.m_oPlayerWrapper.addEventListener("ended",this.m_oEventEnded),this.m_oEventAVSwitch||(this.m_oEventAVSwitch=this._onMediaAVSwitch.bind(this)),this.m_oPlayerWrapper.addEventListener(AXIOM_MEDIA_PLAYER_AV_SWITCH,this.m_oEventAVSwitch),this.m_oEventCanPlay||(this.m_oEventCanPlay=this._onMediaCanPlay.bind(this)),this.m_oPlayerWrapper.addEventListener("canplay",this.m_oEventCanPlay),this.m_oEventCustomHeaders||(this.m_oEventCustomHeaders=this._onCustomHeaders.bind(this)),this.m_oPlayerWrapper.addEventListener(AXIOM_MEDIA_PLAYER_CUSTOM_HEADERS,this.m_oEventCustomHeaders))},AxiomMediaPlayer.prototype._dispatchEvent=function(cCall,oItem){if(this.m_oCallHandlers&&this.m_oCallHandlers[cCall])for(var aCalls=this.m_oCallHandlers[cCall],iLup=0;iLup<aCalls.length;)aCalls[iLup](oItem),iLup++},AxiomMediaPlayer.prototype._onMediaClick=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_CLICK,oEvent)},AxiomMediaPlayer.prototype._onMediaPlay=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_PLAY,null)},AxiomMediaPlayer.prototype._onMediaPause=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_PAUSE,null)},AxiomMediaPlayer.prototype._onMediaSeeking=function(){this._dispatchEvent(AXIOM_MEDIA_PLAYER_SEEKING,{SeekTime:this.m_iSeekTime,CurrentTime:this.getCurrentTime()})},AxiomMediaPlayer.prototype._onMediaSeeked=function(){var iTime=this.m_iSeekTime;this.m_iSeekTime=0,this._dispatchEvent(AXIOM_MEDIA_PLAYER_SEEKED,{SeekTime:iTime,CurrentTime:this.getCurrentTime()})},AxiomMediaPlayer.prototype._onMediaComplete=function(oEvent){this.SaveCurrentMediaViewTime(),this._dispatchEvent(AXIOM_MEDIA_PLAYER_COMPLETE,null)},AxiomMediaPlayer.prototype._onMediaAVSwitch=function(oEvent){this.bPendingMediaSwitch=!0,this._dispatchEvent(AXIOM_MEDIA_PLAYER_AV_SWITCH,oEvent.hasVideo?1:-1)},AxiomMediaPlayer.prototype._onMediaCanPlay=function(oEvent){setTimeout(this._onMediaAutoPlayCheck.bind(this),500)},AxiomMediaPlayer.prototype._onCustomHeaders=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_CUSTOM_HEADERS,oEvent)},AxiomMediaPlayer.prototype._onMediaPlayBackError=function(cError){this._dispatchEvent(AXIOM_MEDIA_PLAYER_PLAYBACK_ERROR,cError)},AxiomMediaPlayer.prototype._onMediaError=function(oError){this.m_bPendingStop||oError&&this._dispatchEvent(AXIOM_MEDIA_PLAYER_ERROR,oError)},AxiomMediaPlayer.prototype._onMediaQualityChange=function(oEvent){this.m_bPendingStop||this.m_oPlayerWrapper&&(this.m_iCurrentQualityLevel=this.getCurrentQuality(),oEvent.UserInitiated=this.m_bPendingUserInitiated,this._dispatchEvent(AXIOM_MEDIA_PLAYER_QUALITY_CHANGE,oEvent),this._dispatchEvent(AXIOM_MEDIA_PLAYER_QUALITY_COMPLETED,oEvent))},AxiomMediaPlayer.prototype._onMediaQualityComplete=function(oEvent){oEvent.UserInitiated=this.m_bPendingUserInitiated,this._dispatchEvent(AXIOM_MEDIA_PLAYER_QUALITY_COMPLETED,oEvent)},AxiomMediaPlayer.prototype._onMediaBufferUpdate=function(oEvent){if(!this.m_bPendingStop&&oEvent&&this.m_oPlayerWrapper){var oCallEvent={buffering:oEvent.buffering};oEvent.buffering?(oCallEvent.state="bufferStalled",oCallEvent.time=0):(oCallEvent.state="bufferLoaded",oCallEvent.time=oEvent.bufferingTime?oEvent.bufferingTime:0),this._dispatchEvent(AXIOM_MEDIA_PLAYER_BUFFER_UPDATED,oEvent),this._dispatchEvent(AXIOM_MEDIA_PLAYER_BUFFER_UPDATED_LIVE,oCallEvent)}},AxiomMediaPlayer.prototype._onMediaVolumeChange=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_VOLUME_CHANGE,oEvent)},AxiomMediaPlayer.prototype._onMediaDurationChange=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_DURATION_CHANGE,oEvent)},AxiomMediaPlayer.prototype._onMediaMetaDataLoaded=function(oEvent){if(this.setVolume(this.m_oParams.DefaultVolume),this.m_oPlayerWrapper){var bShouldBePlaying=this.m_bAutoPlay;this.bPendingMediaSwitch?(this.bPendingMediaSwitch=!1,this.play(),bShouldBePlaying=!0):(!this.m_bInitialPlay&&this.m_bAutoPlay&&this.isPaused()&&(this.m_bInitialPlay=!0,this.play()),this._dispatchEvent(AXIOM_MEDIA_PLAYER_METADATA_LOADED,oEvent)),bShouldBePlaying&&!this.m_bInitialLoad&&this.isPaused()&&(this.m_bInitialLoad=!0,setTimeout(this._onMediaAutoPlayCheck.bind(this),500))}},AxiomMediaPlayer.prototype._onMediaDataLoaded=function(oEvent){this.m_oPlayerWrapper&&this._dispatchEvent(AXIOM_MEDIA_PLAYER_DATA_LOADED,oEvent)},AxiomMediaPlayer.prototype._onMediaAutoPlayCheck=function(){!this.m_bAutoPlayChecked&&this.isPaused()&&(this.m_bAutoPlayChecked=!0,this._dispatchEvent(AXIOM_MEDIA_PLAYER_AUTO_PLAY_FAILED,null))},AxiomMediaPlayer.prototype._onMediaTimeUpdate=function(oEvent){this.m_iPreviousTime=this.getCurrentTime(),this.bIsLive||this.m_bTrackView&&this.m_oSettings.MediaViewSaveInternal>0&&this.m_iPreviousTime-this.m_iLastMediaViewSaveTime>=1e3*this.m_oSettings.MediaViewSaveInternal&&(this.m_iLastMediaViewSaveTime=this.m_iPreviousTime,this.SaveCurrentMediaViewTime()),this._dispatchEvent(AXIOM_MEDIA_PLAYER_TIME_UPDATE,null)},AxiomMediaPlayer.prototype.SaveCurrentMediaViewTime=function(){if(!this.bIsLive&&this.m_bTrackView&&this.m_oSettings.MediaViewSaveInternal>-1){var iTime=Math.round(this.getCurrentTime());this.m_iMediaDurationWatched<iTime&&(this.m_iMediaDurationWatched=iTime);var cURL=this.m_oSettings.LASFileName+"?LASCmd=AI:"+this.m_oSettings.InstanceID+";F:LBSEXPORT!JSON&SQLID=18603&EventKey="+this.m_oSettings.EventKey+"&ShowKey="+this.m_oSettings.ShowKey+"&ShowUserKey="+this.m_oSettings.UserKey+"&UserType="+this.m_oSettings.UserType+"&Duration="+this.m_iMediaDurationWatched+"&ResumePoint="+iTime;new AxiomHTTP(cURL,null,!0)}},AxiomMediaPlayer.prototype._onWebkitEndFullscreen=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_WEBKIT_END_FULLSCREEN,oEvent)},AxiomMediaPlayer.prototype._onErrorEvent=function(error){this._dispatchEvent(AXIOM_MEDIA_PLAYER_DEBUG,"Error code "+error.code)},AxiomMediaPlayer.prototype._onRTCStateUpdate=function(oEvent){this._dispatchEvent(AXIOM_MEDIA_PLAYER_RTC_UPDATE,{state:oEvent.state,data:oEvent.data})},AxiomMediaPlayer.prototype.terminateWebRTC=function(){this.m_oPlayerWrapper&&this.m_oPlayerWrapper.terminate()},AxiomMediaPlayer.prototype.switchHTMLVideoToAudio=function(){this.m_oPlayerWrapper&&(this.bPendingMediaSwitch=!0,this.m_oPlayerWrapper.audioOnly=!0)},AxiomMediaPlayer.prototype.switchHTMLAudioToVideo=function(){this.m_oPlayerWrapper&&(this.bPendingMediaSwitch=!0,this.m_oPlayerWrapper.audioOnly=!1)},AxiomMediaPlayer.prototype._onMediaManifestLoaded=function(oEvent){},AxiomMediaPlayer.prototype.getBytesLoaded=function(){var iTotalByteCount=0,iByteCount=0;this.m_oPlayerWrapper&&(iTotalByteCount=this.m_oPlayerWrapper.getStats().totalByteCount);return this.m_iLastTotalByteCount>0&&(iByteCount=iTotalByteCount-this.m_iLastTotalByteCount),this.m_iLastTotalByteCount=iTotalByteCount,iByteCount},AxiomMediaPlayer.prototype.SendInfo=function(){if(this.bIsLive&&this.bLoaded&&!this.bWebRTC&&!this.bScreenShare&&this.m_oCommManager){var oInfo={};oInfo.AttendeeKey=parseInt(this.m_cAttendeeKey),oInfo.UserKey=this.m_oSettings.UserKey,oInfo.OutputKey=this.m_iOutputKey,oInfo.StreamType=this.m_iStreamType,oInfo.PlayerType=this.m_iPlayerType;var iCDNType=this.CDNType;switch(iCDNType){case ECDN_TYPE_KOLLECTIVE:iCDNType=CDN_TYPE_KOLLECTIVE;break;case ECDN_TYPE_RAMP_MULTICAST:iCDNType=CDN_TYPE_RAMP_MULTICAST;break;case ECDN_TYPE_RAMP_OMNI_CACHE:iCDNType=CDN_TYPE_RAMP_OMNI_CACHE}oInfo.CDNType=iCDNType,this.m_oCommManager.SendAnalyticsStreamStart(this.m_cSocketName,null,oInfo)}},AxiomMediaPlayer.prototype._init2=function(fnOnComplete){if(!this.bIsLive&&this.m_bTrackView&&(IsMobile()||IsIPad()?window.addEventListener("pagehide",this._onWindowUnload.bind(this)):(window.addEventListener("beforeunload",this._onWindowUnload.bind(this)),window.addEventListener("unload",this._onWindowUnload.bind(this)))),this.m_oSettings&&this.m_oSettings.EventAttendeeKey&&this.m_oParams.IceServers)this.m_iStreamType=AXIOM_CLIENT_STREAMDELIVERY_WEBRTC,this.m_iInitPlayerTime=(new Date).getTime(),this.bLoaded=!0,this.bWebRTC=!0,this.m_oPlayerWrapper&&(this.m_oPlayerWrapper.element.parentNode&&this.m_oPlayerWrapper.element.parentNode.removeChild(this.m_oPlayerWrapper.element),this.m_oPlayerWrapper.destroy()),this.m_oPlayerWrapper=new WebRTCWrapper,this.m_oMediaContainer.appendChild(this.m_oPlayerWrapper.element),this._setMediaEventListeners(),this.m_oPlayerWrapper.loadSource(this.m_oParams,this.m_oSettings),this.m_oPlayer=this.m_oPlayerWrapper.getPlayerObject(),this.oWebRTC=this.m_oPlayerWrapper.webrtc;else{switch(window.forceMediaPlayer){case amp.PlayerType.NATIVE:this.bHTML=!0,this.bHLS=!0;break;case amp.PlayerType.SHAKA:this.loadShaka(!0,!0);break;case amp.PlayerType.THEO:this.loadTHEO(!0);break;default:!window.MediaSource&&IsIE()?this.loadTHEO(!0):this.bIOS?(this.bHTML5=!0,this.bHLS=!0):window.shaka||this.loadShaka(!0)}this.bIOS?this.m_iPlayerType=AXIOM_CLIENT_PLAYER_IOSBROWSER:this.m_iPlayerType=IsAndroid()?AXIOM_CLIENT_PLAYER_ANDROIDBROWSER:IsWindowsPhone()?AXIOM_CLIENT_PLAYER_WPBROWSER:AXIOM_CLIENT_PLAYER_HTML5}this._loadScripts(0,fnOnComplete)},AxiomMediaPlayer.prototype.loadShaka=function(bOnlyInsert,bIncludeMux,fnOnComplete){var iLup;this.bShaka=!0;var bExists=!1,bMuxExists=!1,cURL=g_oSettings.ScriptDir+"/ThirdParty/shaka-player/2.5.1/shaka-player.compiled.js",cMuxURL=g_oSettings.ScriptDir+"/ThirdParty/muxjs/5.1.2/mux.js";for(iLup=0;iLup<this.m_aLoadScripts.length;iLup++){if(this.m_aLoadScripts[iLup].src==cURL){bExists=!0;break}if(this.m_aLoadScripts[iLup].src==cMuxURL){bMuxExists=!0;break}}bExists||this.m_aLoadScripts.push({src:cURL}),bIncludeMux&&!bMuxExists&&this.m_aLoadScripts.push({src:cMuxURL}),bOnlyInsert||this._loadScripts(0,fnOnComplete)},AxiomMediaPlayer.prototype.loadTHEO=function(bOnlyInsert,bIncludeMux,fnOnComplete){this.bTHEO=!0;for(var cURL=g_oSettings.ScriptDir+"/ThirdParty/THEOplayer/2.57.0/THEOplayer.chromeless.js",bExists=!1,iLup=0;iLup<this.m_aLoadScripts.length;iLup++)if(this.m_aLoadScripts[iLup].src==cURL){bExists=!0;break}bExists||this.m_aLoadScripts.push({src:cURL}),bOnlyInsert||this._loadScripts(0,fnOnComplete)},AxiomMediaPlayer.prototype._loadScripts=function(iIndex,fnOnComplete){var _this=this;this.m_bLoadingScripts=!0,iIndex<_this.m_aLoadScripts.length?_this.m_aLoadScripts[iIndex].completed?_this._loadScripts.call(_this,++iIndex,_this._loadScriptsOnComplete.bind(_this,fnOnComplete)):LoadScript(_this.m_aLoadScripts[iIndex].src,function(){_this.m_aLoadScripts[iIndex].completed=!0,_this._loadScripts.call(_this,++iIndex,_this._loadScriptsOnComplete.bind(_this,fnOnComplete))}):_this._loadScriptsOnComplete.call(_this,fnOnComplete)},AxiomMediaPlayer.prototype._loadScriptsOnComplete=function(fnOnComplete){switch(window.forceMediaPlayer){case amp.PlayerType.NATIVE:case amp.PlayerType.THEO:this.bShaka=!1;break;case amp.PlayerType.SHAKA:shaka.polyfill.installAll(),this.bShaka=shaka.Player&&shaka.Player.isBrowserSupported();break;default:window.shaka?(shaka.polyfill.installAll(),this.bShaka=shaka.Player&&shaka.Player.isBrowserSupported()):this.bShaka=!1,!this.bShaka&&IsIE()&&IEVersion()<12&&(this.bTHEO=!0)}this.m_bLoadingScripts=!1,fnOnComplete&&fnOnComplete()},AxiomMediaPlayer.prototype.doesSupportSource=function(cURL,iTimeoutMS,fnOnComplete){var _this=this,bAutoValid=!1;if("blob:"==cURL.substr(0,5)&&(bAutoValid=!0),!bAutoValid){var cTemp=cURL,iTemp=cURL.indexOf("?");iTemp>-1&&(cTemp=cTemp.substr(0,iTemp)),(iTemp=cTemp.lastIndexOf("."))>-1&&(bAutoValid="mp4"==(cTemp=cTemp.substr(iTemp+1))||"mp3"==cTemp)}if(bAutoValid)_this.bHTML5=!0,fnOnComplete&&fnOnComplete(!0);else{var iTimeout=setTimeout(function(){iTimeout=0,fnOnComplete&&fnOnComplete(!1)},iTimeoutMS),oReq=new XMLHttpRequest;oReq.addEventListener("load",function(oEvent){if(iTimeout)if(clearTimeout(iTimeout),oReq.response&&oReq.response.length>0){var cContentType=oReq.getResponseHeader("content-type");switch(window.forceMediaPlayer){case amp.PlayerType.NATIVE:_this.bHTML5=!0,"application/dash+xml"==cContentType?fnOnComplete(!1):fnOnComplete(!0,cContentType);break;case amp.PlayerType.SHAKA:_this.bShaka=!0,fnOnComplete&&fnOnComplete(!0,cContentType);break;case amp.PlayerType.THEO:_this.bTHEO=!0,fnOnComplete&&("application/dash+xml"==cContentType?fnOnComplete(!1):fnOnComplete(!0,cContentType));break;default:if(cContentType&&!IsEdge()){var oElem=document.createElement("video");_this.bHTML5=!!oElem.canPlayType,_this.bHTML5&&(_this.bHTML5=""!==oElem.canPlayType(cContentType))}_this.bHTML5?fnOnComplete&&fnOnComplete(!0,cContentType):_this.bShaka?fnOnComplete&&fnOnComplete(!0,cContentType):_this.bTHEO?window.THEOplayer?"application/dash+xml"==cContentType?fnOnComplete(!1):fnOnComplete(!0,cContentType):(_this.m_aLoadScripts.push({src:g_oSettings.ScriptDir+"/ThirdParty/THEOplayer/2.57.0/THEOplayer.chromeless.js"}),_this._loadScripts(_this.m_aLoadScripts.length-1,function(){"application/dash+xml"==cContentType?fnOnComplete(!1):fnOnComplete(!0,cContentType)})):fnOnComplete&&fnOnComplete(!1)}}else fnOnComplete&&fnOnComplete(!1)}),oReq.addEventListener("error",function(oEvent){iTimeout&&(clearTimeout(iTimeout),fnOnComplete&&fnOnComplete(!1))}),oReq.open("GET",cURL),oReq.send()}},AxiomMediaPlayer.prototype.loadSource=function(cURL,iTimeoutMS,fnOnComplete){this.m_iLastTotalByteCount=0,this.bLoaded=!1,this.m_iOutputKey=0,this.m_bInitialPlay=!1,this.m_bInitialLoad=!1,this.m_bPendingStop=!1;var _this=this;iTimeoutMS=parseInt(iTimeoutMS),isNaN(iTimeoutMS)&&(iTimeoutMS=1e3),_this.m_bLoadingScripts?setTimeout(_this.loadSource.bind(_this,cURL,iTimeoutMS,fnOnComplete),100):_this.doesSupportSource(cURL,iTimeoutMS,function(bSupports,cContentType){if(bSupports){var oStreamingParameters;_this.loadPlayerWrapperMapped(cURL),_this.m_oPlayerWrapper||(_this.bHTML5?_this.m_oPlayerWrapper=new DefaultVideoWrapper:_this.bShaka?_this.m_oPlayerWrapper=new ShakaWrapper:_this.bTHEO&&(_this.m_oPlayerWrapper=new THEOWrapper),_this._setMediaEventListeners(),_this.m_oMediaContainer.appendChild(_this.m_oPlayerWrapper.element),_this.m_oPlayer=_this.m_oPlayerWrapper.getPlayerObject()),_this.bShaka&&(oStreamingParameters=_this.bIsLive?{jumpLargeGaps:!0,bufferingGoal:2*_this.m_iDashLiveDelaySeconds,rebufferingGoal:_this.m_iDashLiveDelaySeconds,bufferBehind:_this.m_iDashLiveDelaySeconds,retryParameters:{maxAttempts:3,baseDelay:500,backoffFactor:1.5,fuzzFactor:.5}}:{jumpLargeGaps:!0,bufferingGoal:30*_this.m_iDashLiveDelaySeconds,rebufferingGoal:2*_this.m_iDashLiveDelaySeconds,bufferBehind:4*_this.m_iDashLiveDelaySeconds,retryParameters:{maxAttempts:3,baseDelay:500,backoffFactor:1.5,fuzzFactor:.5}}),_this.m_bAudioOnly&&(_this.m_oPlayerWrapper.audioOnly=!0),_this.m_oPlayerWrapper.autoplay=_this.m_bAutoPlay,_this.m_oPlayerWrapper.loadSource(cURL,cContentType,oStreamingParameters);var bHTTPS=-1!=cURL.toUpperCase().indexOf("HTTPS://");-1!=cURL.toUpperCase().indexOf(".M3U8")?_this.m_iStreamType=bHTTPS?AXIOM_CLIENT_STREAMDELIVERY_HLS_HTTPS:AXIOM_CLIENT_STREAMDELIVERY_HLS_HTTP:-1!=cURL.toUpperCase().indexOf(".MPD")&&(_this.m_iStreamType=bHTTPS?AXIOM_CLIENT_STREAMDELIVERY_DASH_HTTPS:AXIOM_CLIENT_STREAMDELIVERY_DASH_HTTP),_this.bLoaded=!0}fnOnComplete&&fnOnComplete(bSupports)})},AxiomMediaPlayer.prototype.setPlayerWrapper=function(oPlayerWrapper){oPlayerWrapper instanceof DefaultVideoWrapper?(this.bHTML5=!0,this.m_oPlayerWrapper=oPlayerWrapper,this.m_oMediaContainer.appendChild(this.m_oPlayerWrapper.element),this.m_oPlayer=this.m_oPlayerWrapper.getPlayerObject(),this._setMediaEventListeners()):oPlayerWrapper instanceof ShakaWrapper?(this.bShaka=!0,this.m_oPlayerWrapper=oPlayerWrapper,this.m_oMediaContainer.appendChild(this.m_oPlayerWrapper.element),this.m_oPlayer=this.m_oPlayerWrapper.getPlayerObject(),this._setMediaEventListeners()):oPlayerWrapper instanceof THEOWrapper&&(this.bTHEO=!0,this.m_oPlayerWrapper=oPlayerWrapper,this.m_oMediaContainer.appendChild(this.m_oPlayerWrapper.element),this.m_oPlayer=this.m_oPlayerWrapper.getPlayerObject(),this._setMediaEventListeners())},AxiomMediaPlayer.prototype.mapPlayerWrapper=function(cSource,oPlayer){this.m_oSrcToPlayerWrapperMap[cSource]=oPlayer},AxiomMediaPlayer.prototype.loadPlayerWrapperMapped=function(cSource){var oWrapper=this.m_oSrcToPlayerWrapperMap[cSource];oWrapper&&this.setPlayerWrapper(oWrapper)};