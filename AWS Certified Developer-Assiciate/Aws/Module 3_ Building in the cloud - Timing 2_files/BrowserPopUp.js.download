var BrowserPopUp=function(){var _this=this,m_oModal=null,m_oModalBG=null,m_oTextArea=null,m_oButtonContainer=null,m_oHeader=null,m_oContentContainer=null,m_aButtons=null,m_bHideHeader=!1,m_bDisableModalBGClick=!1;this.ExternalUseFlag=0;var m_fnCloseCB=null,m_fnHeightCalc=null;function onKeyUp(oEvent){27!=(oEvent.which?oEvent.which:oEvent.keyCode)||_this.IsEditableElemActive()||_this.CloseModal()}this.IsEditableElemActive=function(){var oNodeName=document.activeElement.nodeName.toLowerCase();return"input"==oNodeName||"textarea"==oNodeName||"select"==oNodeName},this.IsOpen=function(){return"1"==m_oModal.getAttribute("data-state")},this.CloseModal=function(){m_fnCloseCB&&m_fnCloseCB(),_this.Clean(),m_oModal.removeAttribute("data-state"),window.removeEventListener("keyup",onKeyUp)},this.Clean=function(){for(_this.ExternalUseFlag=0,m_fnHeightCalc=null,m_fnCloseCB=null,m_oTextArea.innerHTML="",m_oHeader.innerHTML="",_this.SetHideHeader(!1),_this.SetDisableModalBGClick(!1);m_oButtonContainer.childNodes.length;)m_oButtonContainer.removeChild(m_oButtonContainer.firstChild)},this.OpenModal=function(bDisableEscape){m_oModal.setAttribute("data-state",1),m_oContentContainer.style.transition="none",bDisableEscape||window.addEventListener("keyup",onKeyUp);var iHeight=0;m_fnHeightCalc?iHeight=m_fnHeightCalc({header:m_oHeader.scrollHeight}):(iHeight=m_oHeader.scrollHeight+m_oTextArea.scrollHeight,m_oButtonContainer.childNodes.length>0&&(iHeight+=m_oButtonContainer.scrollHeight)),m_oContentContainer.style.height=iHeight+"px",m_oContentContainer.style.transition="",m_oTextArea.focus()},this.SetHeightCalculator=function(fnHeightCalc){m_fnHeightCalc=fnHeightCalc},this.SetContentElement=function(oElement){m_oTextArea.appendChild(oElement)},this.SetHeaderElement=function(oElement){m_oHeader.appendChild(oElement)},this.AddButtons=function(aButtons){if(aButtons&&aButtons.length)for(var iLup=0;iLup<aButtons.length;iLup++)m_oButtonContainer.appendChild(aButtons[iLup].GetNode()),iLup>0&&(aButtons[iLup].GetNode().style.marginLeft="10px")},this.SetContentHTML=function(oHTMLData){m_oTextArea.appendChild(oHTMLData)},this.SetHeaderHTML=function(oHTMLData){m_oHeader.appendChild(oHTMLData)},this.SetContentText=function(cMessage){var oP=document.createElement("P");oP.innerHTML=cMessage,oP.className="AxiomStandardText",m_oTextArea.innerHTML=oP.outerHTML},this.SetHeaderText=function(cMessage){var oP=document.createElement("P");oP.className="AxiomHeading",oP.appendChild(document.createTextNode(cMessage||"Alert")),m_oHeader.innerHTML=oP.outerHTML},this.Alert=function(cMessage,fnPost){cMessage&&(_this.Clean(),_this.SetContentText(cMessage),_this.SetHeaderText(),m_aButtons="function"!=typeof fnPost?[new BrowserPopUpButton("OK",_this.CloseModal)]:[new BrowserPopUpButton("OK",function(){_this.CloseModal(),fnPost()})],m_oButtonContainer.appendChild(m_aButtons[0].GetNode()),m_aButtons[0].GetNode().focus(),_this.OpenModal())},this.MakeMessageBox=function(cMessage,cHeaderText,aButtons){cMessage&&(_this.Clean(),_this.SetHeaderText(cHeaderText),_this.SetContentText(cMessage),_this.AddButtons(aButtons),_this.OpenModal())},this.SetModalCloseCB=function(fnCallback){"function"==typeof fnCallback&&(m_fnCloseCB=fnCallback)},this.RemoveModalCB=function(){m_fnCloseCB=null},this.SetModal=function(oModal){m_oModal=oModal},this.SetModalBG=function(oBGElem){m_oModalBG=oBGElem,m_bDisableModalBGClick||(m_oModalBG.style.cursor="pointer",m_oModalBG.addEventListener("click",_this.CloseModal))},this.SetHeader=function(oModalHeader){m_oHeader=oModalHeader,m_bHideHeader&&(m_oHeader.style.display="none")},this.GetHeader=function(){return m_oHeader},this.SetTextArea=function(oTextArea){(m_oTextArea=oTextArea).setAttribute("tabIndex",-1)},this.GetTextArea=function(){return m_oTextArea},this.SetButtonContainer=function(oButtonContainer){m_oButtonContainer=oButtonContainer},this.SetContentContainer=function(oContentContainer){m_oContentContainer=oContentContainer},this.GetContentContainer=function(){return m_oContentContainer},this.SetHideHeader=function(bHideHeader){m_bHideHeader=bHideHeader,m_oHeader&&(m_oHeader.style.display=m_bHideHeader?"none":"")},this.SetDisableModalBGClick=function(bDisableModalBGClick){m_bDisableModalBGClick=bDisableModalBGClick,m_oModalBG&&(m_bDisableModalBGClick?(m_oModalBG.style.cursor="default",m_oModalBG.removeEventListener("click",_this.CloseModal)):(m_oModalBG.style.cursor="pointer",m_oModalBG.addEventListener("click",_this.CloseModal)))}},BrowserPopUpButton=function(cText,fnClickFunction,cClass){var oElem,m_oNode=null,m_fnClick=fnClickFunction,m_cText=cText,m_cClass=cClass;function KeyUp(evt){var iKeyCode=evt.which?evt.which:evt.keyCode;return 13!=iKeyCode&&32!=iKeyCode||m_fnClick(),CancelEvent(evt)}this.GetNode=function(){return m_oNode},(oElem=document.createElement("DIV")).className=m_cClass||"AxiomGeneralActionButton",oElem.appendChild(document.createTextNode(m_cText)),oElem.addEventListener("click",m_fnClick),oElem.addEventListener("keyup",KeyUp),oElem.setAttribute("tabIndex",1),m_oNode=oElem};function BrowserPopUpButton2(cText,fnOnClick,cClass,cDisableClass){var m_oContent,_this=this,m_cText=cText,m_fnClick=fnOnClick,m_cClass=cClass,m_cDisableClass=cDisableClass||cClass,m_bEnabled=!1;this.GetNode=function(){return m_oContent},this.enable=function(){m_bEnabled||(m_oContent.className=m_cClass,m_oContent.addEventListener("click",m_fnClick),m_bEnabled=!0)},this.disable=function(){m_bEnabled&&(m_oContent.className=m_cDisableClass,m_oContent.removeEventListener("click",m_fnClick),m_bEnabled=!1)},(m_oContent=document.createElement("div")).appendChild(document.createTextNode(m_cText)),m_oContent.setAttribute("tabIndex",1),_this.enable()}