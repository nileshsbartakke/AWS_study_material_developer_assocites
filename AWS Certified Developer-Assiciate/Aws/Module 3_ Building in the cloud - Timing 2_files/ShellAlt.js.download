function AltShellCheck(){try{var oTop=GetShellWnd();void 0==oTop||null==oTop?RestoreShellState():oTop&&oTop!=window.top&&void 0!==oTop.AddNotifyCandidate&&oTop.AddNotifyCandidate(window.top)}catch(e){}}function RestoreShellState(){if("object"==typeof localStorage&&"object"==typeof JSON){var oState=JSON.parse(localStorage.getItem("ShellState"+g_cShowKey));if(oState)for(var cName in oState)window[cName]=oState[cName];var oMessages=JSON.parse(localStorage.getItem("ShellMessages"+g_cShowKey));window.g_oMessages=oMessages||{}}localStorage.removeItem("ShellState"+g_cShowKey),localStorage.removeItem("ShellMessages"+g_cShowKey),window.g_oSize=GetWindowSize(),window.g_bAlternateShell=!0,LoadStylesheet("/cfr/Stylesheets/Notification.css"),LoadScript("/cfr/scripts/VTS/RPC.js",OnLoadRPC),LoadScript("/cfr/scripts/VTS/Notification.js",OnLoadNotification)}function CaptureShellState(){if("object"==typeof localStorage&&"object"==typeof JSON){if(g_aMsgAreas)for(var i=0;i<g_aMsgAreas.length;i++)g_aMsgAreas[i].divObj&&delete g_aMsgAreas[i].divObj;var oState={g_iInstanceID:g_iInstanceID,g_cShowTypeDesc:g_cShowTypeDesc,g_cLASServerName:g_cLASServerName,g_cLASFileName:g_cLASFileName,g_cImageDir:g_cImageDir,g_iChatStatus:g_iChatStatus,g_iDisableCustomChatDeclineMessage:g_iDisableCustomChatDeclineMessage,g_iChatTechnology:g_iChatTechnology,g_iShowChatInviteMessage:g_iShowChatInviteMessage,g_bAutoAcceptPrivateChats:g_bAutoAcceptPrivateChats,g_iUserType:g_iUserType,g_cUserID:g_cUserID,g_cUserName:g_cUserName,g_cLocaleID:g_cLocaleID,g_bMobileLayout:g_bMobileLayout,g_aMsgAreas:g_aMsgAreas,g_oTransferValues:{g_cLastDeclineMsg:g_cLastDeclineMsg,g_iAllowedSecondsNonNormalChatStatus:g_iAllowedSecondsNonNormalChatStatus,g_iSecondsNonNormalChatStatus:g_iSecondsNonNormalChatStatus,g_iPlayBoothVisitorSound:g_iPlayBoothVisitorSound,g_iShowChatNotifyPopup:g_iShowChatNotifyPopup,g_iNotificationCheckIntervalSecs:g_iNotificationCheckIntervalSecs,g_cHTMLDeclineParams:g_cHTMLDeclineParams,g_bIsHTML5:g_bIsHTML5}};localStorage.setItem("ShellState"+g_cShowKey,JSON.stringify(oState));var oMessages={NewMail:g_oMessages.NewMail,NewVCard:g_oMessages.NewVCard,Dismiss:g_oMessages.Dismiss,NewChat:g_oMessages.NewChat,DeclineMessageLabel:g_oMessages.DeclineMessageLabel,Accept:g_oMessages.Accept,Decline:g_oMessages.Decline,Announcement:g_oMessages.Announcement,BadgeAward:g_oMessages.BadgeAward,WatchVideo:g_oMessages.WatchVideo,BuddyLogin:g_oMessages.BuddyLogin,Subject:g_oMessages.Subject,Open:g_oMessages.Open,Save:g_oMessages.Save,Delete:g_oMessages.Delete,BuddyRequest:g_oMessages.BuddyRequest,Ignore:g_oMessages.Ignore,Logout:g_oMessages.Logout};localStorage.setItem("ShellMessages"+g_cShowKey,JSON.stringify(oMessages))}}window.addEventListener?window.addEventListener("load",AltShellCheck,!1):window.attachEvent&&window.attachEvent("onload",AltShellCheck);