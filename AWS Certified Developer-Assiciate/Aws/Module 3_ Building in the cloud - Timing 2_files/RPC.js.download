var RPC={cName:"",iInstance:1,aHandlers:[],oWnd:{},Init:function(cName,iInstance,fnHandler){this.cName.length||(window.RPCName=cName,"number"==typeof iInstance&&(this.iInstance=iInstance),"string"==typeof cName&&cName.length&&this.CreateCommTarget(cName),"function"==typeof fnHandler&&this.AddHandler(fnHandler))},CreateCommTarget:function(cName){if(!document.getElementById(cName)){this.cName=cName;var oFrame=document.createElement("IFRAME");oFrame.style.display="none",oFrame.setAttribute("name",cName),oFrame.setAttribute("id",cName),oFrame.setAttribute("src","/cfr/StdHTML/Loading.htm"),document.body.appendChild(oFrame),document.frames&&(document.frames[document.frames.length-1].name=cName),this.oWnd[cName]=window}},AddHandler:function(fnHandler){if("function"==typeof fnHandler){for(var iLup=0;iLup<this.aHandlers.length;iLup++)if(this.aHandlers[iLup]==fnHandler)return;this.aHandlers.push(fnHandler)}},RemoveHandler:function(fnHandler){if("function"==typeof fnHandler)for(var iLup=0;iLup<this.aHandlers.length;iLup++)if(this.aHandlers[iLup]==fnHandler){this.aHandlers.splice(iLup,1);break}},Connect:function(cTarget){if(this.oWnd[cTarget])return this.oWnd[cTarget];var oWnd=open("",cTarget);return oWnd?oWnd.top==oWnd?(oWnd.close(),null):((oWnd=oWnd.parent.window).RPCName=cTarget,AddEventHandler(oWnd,"unload",this.OnUnload),oWnd.RPC&&(oWnd.RPC.oWnd[this.cName]=window,AddEventHandler(window,"unload",oWnd.RPC.OnUnload)),this.oWnd[cTarget]=oWnd,oWnd):null},Receive:function(oCommand){if("object"==typeof oCommand){for(var bClean=!1,iLup=0;iLup<this.aHandlers.length;iLup++)try{this.aHandlers[iLup](oCommand)}catch(e){this.aHandlers[iLup]=null,bClean=!0}if(bClean)for(iLup=this.aHandlers.length-1;iLup>=0;iLup--)this.aHandlers[iLup]||this.aHandlers.splice(iLup,1)}},TargetExists:function(cTarget,cIgnore){if(this.oWnd[cTarget])return!0;for(var cName in this.oWnd)if(cName!=cIgnore&&this.oWnd[cName].RPCName!=this.cName)return this.oWnd[cName].RPC.TargetExists(cTarget,this.cName);return!1},OnUnload:function(evt){try{var oWnd=evt.target?evt.target:evt.srcElement;oWnd&&oWnd.RPCName&&RPC.oWnd[oWnd.RPCName]&&delete RPC.oWnd[oWnd.RPCName]}catch(e){}},WQ:{aQueue:[],iTimer:null,Next:function(){if(RPC.WQ.aQueue.length){var oJob=RPC.WQ.aQueue.shift();oJob.Worker(oJob.Arg),RPC.WQ.aQueue.length?RPC.WQ.iTimer=setTimeout(RPC.WQ.Next,1):RPC.WQ.iTimer=null}},Add:function(oJob){RPC.WQ.aQueue.push(oJob),RPC.WQ.iTimer||(RPC.WQ.iTimer=setTimeout(RPC.WQ.Next,1))}}};