function Slider(m_bMobile,m_cClassPostFix,m_oProperties,m_oMovementDetectArea,m_oFnHandlers){var _this=this;_this.Element=document.createElement("div");var m_oSeekHolder,m_oSeekSliderBar,m_oSlideProgress,m_oSeekSliderThumb,m_oFakeThumb,m_oClickTarget,m_fCurrentPercent,m_bEnabled=!0,m_bHorizontal=m_oProperties.horizontal,m_fThumbAtPercent=0,m_bSeeking=!1,m_oSize={height:m_oProperties.height,width:m_oProperties.width},m_iMaxValue=m_bHorizontal?m_oSize.width:m_oSize.height,m_fFurthestTimeSeconds=m_oProperties.furthestTime,m_fDurationSeconds=m_oProperties.duration,m_bFakeThumbActive=!1;function OnMouseUpLeaveSeekBar(oEvent){if(m_bSeeking){m_bSeeking=!1;var fCurrentPercent=m_fCurrentPercent;if(m_oClickTarget){if(!(m_bHorizontal?oEvent.pageX==m_oClickTarget.pageX:oEvent.pageY==m_oClickTarget.pageY))return void(m_oClickTarget=null);var oRect=_this.Element.getBoundingClientRect();fCurrentPercent=m_bHorizontal?(oEvent.pageX-oRect.left)/m_iMaxValue:1-(oEvent.pageY-oRect.top)/m_iMaxValue,m_oClickTarget=null}m_oFnHandlers.OnChangeEnd(fCurrentPercent,m_fFurthestTimeSeconds>-1&&m_fFurthestTimeSeconds<fCurrentPercent*m_fDurationSeconds)}}function UpdatePageXThumbMovement(fCurrentPosition){var iDelta=m_fLastPosition-fCurrentPosition;m_bHorizontal&&(iDelta*=-1),m_fLastPosition=fCurrentPosition;var fDone=(m_fThumbAtPercent*m_iMaxValue+iDelta)/m_iMaxValue;fDone=Math.max(Math.min(fDone,1),0),m_oFnHandlers.OnChanging(fDone,m_fFurthestTimeSeconds>-1&&m_fFurthestTimeSeconds<fDone*m_fDurationSeconds)}(m_oSeekHolder=document.createElement("div")).className="vp_ControlsSliderHolder"+m_cClassPostFix,m_oSeekHolder.style.height="100%",m_oMovementDetectArea||(m_oMovementDetectArea=m_oSeekHolder),m_bMobile?(mobileAddEventListener(m_oMovementDetectArea,"touchmove",function(oEvent){m_bSeeking&&((oEvent=TouchEvent(oEvent)).stopPropagation(),oEvent.preventDefault(),UpdatePageXThumbMovement(m_bHorizontal?oEvent.touches[0].pageX:oEvent.touches[0].pageY))}),mobileAddEventListener(m_oMovementDetectArea,"touchend",function(oEvent){m_bSeeking&&(oEvent=TouchEvent(oEvent),m_bSeeking=!1,m_oFnHandlers.OnChangeEnd(m_fCurrentPercent))})):(AddEventHandler(m_oMovementDetectArea,"mousemove",function(oEvent){m_bSeeking&&!m_oClickTarget&&UpdatePageXThumbMovement(m_bHorizontal?oEvent.pageX:oEvent.pageY)}),AddEventHandler(m_oMovementDetectArea,"mouseleave",OnMouseUpLeaveSeekBar),AddEventHandler(m_oMovementDetectArea,"mouseup",OnMouseUpLeaveSeekBar)),_this.Element.appendChild(m_oSeekHolder),(m_oSlideProgress=document.createElement("div")).className="vp_ControlsSlideProgress"+m_cClassPostFix,m_oSeekHolder.appendChild(m_oSlideProgress),(m_oSeekSliderBar=document.createElement("div")).className="vp_ControlsSliderBar"+m_cClassPostFix,m_oSeekSliderBar.style.height="100%",m_oSeekSliderBar.style.width="100%",m_oSeekHolder.appendChild(m_oSeekSliderBar),(m_oSeekSliderThumb=document.createElement("div")).className="vp_ControlsSliderThumb"+m_cClassPostFix,AddEventHandler(m_oSeekSliderThumb,"dblclick",function(oEvent){m_oFnHandlers.ThumbDoubleClick&&m_oFnHandlers.ThumbDoubleClick(oEvent)}),(m_oFakeThumb=document.createElement("div")).className="vp_ControlsSliderThumb"+m_cClassPostFix,m_bMobile?(mobileAddEventListener(m_oSeekSliderThumb,"touchstart",function(oEvent){if(!m_bSeeking&&!m_bEnabled)return;oEvent=TouchEvent(oEvent),m_bSeeking=!0,m_fLastPosition=m_bHorizontal?oEvent.touches[0].pageX:oEvent.touches[0].pageY,m_oFnHandlers.OnChangeStart()}),AddEventHandler(m_oSeekHolder,"click",function(oEvent){if(!m_bEnabled)return;var iValue,fCurrentPercent,oRect=oEvent.currentTarget.getBoundingClientRect();m_bHorizontal?(iValue=oEvent.pageX-oRect.left,fCurrentPercent=iValue/m_iMaxValue):(iValue=oEvent.pageY-oRect.top,fCurrentPercent=1-iValue/m_iMaxValue);m_bSeeking=!1,m_oFnHandlers.OnChangeEnd(fCurrentPercent,m_fFurthestTimeSeconds>-1&&m_fFurthestTimeSeconds<fCurrentPercent*m_fDurationSeconds)})):(AddEventHandler(m_oSeekSliderThumb,"mousedown",function(oEvent){if(!m_bSeeking&&!m_bEnabled)return;oEvent.stopPropagation(),oEvent.preventDefault(),m_bSeeking=!0,m_fLastPosition=m_bHorizontal?oEvent.pageX:oEvent.pageY,m_oFnHandlers.OnChangeStart()}),AddEventHandler(m_oSeekHolder,"mousedown",function(oEvent){if(!m_bSeeking&&!m_bEnabled)return;m_bSeeking=!0,m_oClickTarget=oEvent})),m_oSeekHolder.appendChild(m_oSeekSliderThumb),_this.Value=function(fDone,bSticking){if(fDone=Math.max(Math.min(fDone,1),0),m_fThumbAtPercent=fDone,bSticking)m_bFakeThumbActive||(m_oSeekHolder.appendChild(m_oFakeThumb),m_bFakeThumbActive=!0,m_oSeekSliderThumb.style.opacity=.5),m_oFakeThumb.style.left=m_fCurrentPercent*(m_iMaxValue-m_oProperties.thumbWidth)+"px";else{if(m_fCurrentPercent=fDone,m_fFurthestTimeSeconds>-1){var fCurrentSeconds=m_fThumbAtPercent*m_fDurationSeconds;fCurrentSeconds>m_fFurthestTimeSeconds&&(m_fFurthestTimeSeconds=fCurrentSeconds)}m_bFakeThumbActive&&(m_oSeekHolder.removeChild(m_oFakeThumb),m_bFakeThumbActive=!1,m_oSeekSliderThumb.style.opacity="")}return m_bHorizontal?(m_oSeekSliderThumb.style.left=fDone*(m_iMaxValue-m_oProperties.thumbWidth)+"px",m_oSeekSliderBar.style.mozTransform="scaleX("+m_fCurrentPercent+")",m_oSeekSliderBar.style.msTransform="scaleX("+m_fCurrentPercent+")",m_oSeekSliderBar.style.webkitTransform="scaleX("+m_fCurrentPercent+")",m_oSeekSliderBar.style.transform="scaleX("+m_fCurrentPercent+")"):(m_oSeekSliderThumb.style.bottom=fDone*m_iMaxValue-fDone*m_oProperties.thumbHeight+"px",m_oSeekSliderBar.style.mozTransform="scaleY("+m_fCurrentPercent+")",m_oSeekSliderBar.style.msTransform="scaleY("+m_fCurrentPercent+")",m_oSeekSliderBar.style.webkitTransform="scaleY("+m_fCurrentPercent+")",m_oSeekSliderBar.style.transform="scaleY("+m_fCurrentPercent+")"),m_fThumbAtPercent},_this.Disable=function(){m_bEnabled=!1,_this.Element.style.opacity=.7,_this.Element.setAttribute("data-disabled","1")},_this.Enable=function(){m_bEnabled=!0,_this.Element.style.opacity="",_this.Element.removeAttribute("data-disabled")},_this.SetPageSize=function(oSize){m_oSize=oSize,m_iMaxValue=m_bHorizontal?m_oSize.width:m_oSize.height,_this.Element.style.width=oSize.width+"px",_this.Element.style.height=oSize.height+"px",_this.Value(m_fThumbAtPercent)},_this.OnProgressChange=function(fValue){m_oSlideProgress.style.mozTransform="scaleX("+fValue+")",m_oSlideProgress.style.msTransform="scaleX("+fValue+")",m_oSlideProgress.style.webkitTransform="scaleX("+fValue+")",m_oSlideProgress.style.transform="scaleX("+fValue+")"},_this.FurthestTime=function(){return m_fFurthestTimeSeconds},_this.SetThumbText=function(cText){m_oSeekSliderThumb.innerText?m_oSeekSliderThumb.innerText=cText:m_oSeekSliderThumb.textContent=cText},_this.UpdateDurationSeconds=function(iDurationSeconds){m_fDurationSeconds!=iDurationSeconds&&(m_fDurationSeconds=iDurationSeconds)}}