function InxpoAJAXObject(){window.XMLHttpRequest?this.m_oXMLHTTPReqObj=new XMLHttpRequest:this.m_oXMLHTTPReqObj=new ActiveXObject("Microsoft.XMLHTTP"),this.m_aHeaders=new Array}function InxpoAJAXExtractHTMLBody(cHTML){var iPos=cHTML.indexOf("<BODY");if(iPos<0&&(iPos=cHTML.indexOf("<body")),iPos>-1){var iPos2=cHTML.indexOf(">",iPos+1);iPos2>-1&&((iPos=cHTML.indexOf("</body>",iPos2+1))<0&&(iPos=cHTML.indexOf("</BODY>",iPos2+1)),cHTML=iPos>0?cHTML.substring(iPos2+1,iPos):cHTML.substr(iPos2+1))}return cHTML}function InxpoAJAXEvalJSON(cJSON){var cRetval;if(window.JSON)try{cRetval=window.JSON.parse(cJSON)}catch(e){eval("cRetval = ("+cJSON+")")}else eval("cRetval = ("+cJSON+")");return cRetval}function EvalResponse(cResponse){var oResponse=null;try{if(window.JSON)try{oResponse=window.JSON.parse(cResponse)}catch(e){eval("oResponse = "+cResponse)}else eval("oResponse = "+cResponse)}catch(e){"string"==typeof cResponse&&(oResponse=FindErrorMessage(cResponse)),null==oResponse&&(oResponse={Status:1,Diag:"The server is not responding.",ResultSet:[]})}return oResponse}function FindErrorMessage(cResponse){var oResponse=null;try{var iIndex=cResponse.indexOf('"DisplayField"');if(iIndex>-1&&(iIndex=cResponse.indexOf("<td>",iIndex))>-1){iIndex+=4;var iEnd=cResponse.indexOf(".",iIndex);-1==iEnd?iEnd=cResponse.indexOf("</td>",iIndex):iEnd++,oResponse={Status:1,Diag:cResponse=cResponse.substr(iIndex,iEnd-iIndex),ResultSet:[]}}}catch(e){}return oResponse}InxpoAJAXObject.prototype.AddHeader=function(cHeadName,cHeaderValue){this.m_aHeaders.push([cHeadName,cHeaderValue])},InxpoAJAXObject.prototype.SendRequest=function(cMethod,cURL,cPostParams){var aHeader;try{if(this.m_oXMLHTTPReqObj&&(4==this.m_oXMLHTTPReqObj.readyState||0==this.m_oXMLHTTPReqObj.readyState)){var oThis=this;for(this.m_oXMLHTTPReqObj.open(cMethod,cURL,!0),aHeader=this.m_aHeaders.pop();void 0!=aHeader;)this.m_oXMLHTTPReqObj.setRequestHeader(aHeader[0],aHeader[1]),aHeader=this.m_aHeaders.pop();oThis.OnFileUploadProgress&&this.m_oXMLHTTPReqObj.upload&&(this.m_oXMLHTTPReqObj.upload.onprogress=function(oEventP){oThis.OnFileUploadProgress(oEventP)}),this.m_oXMLHTTPReqObj.onreadystatechange=function(){oThis.ReadyStateChange()},this.m_oXMLHTTPReqObj.send(cPostParams)}}catch(e){}},InxpoAJAXObject.prototype.SendSyncRequest=function(cMethod,cURL,cPostParams,bEvalResponse){var oResponse=null;try{if(this.m_oXMLHTTPReqObj&&(4==this.m_oXMLHTTPReqObj.readyState||0==this.m_oXMLHTTPReqObj.readyState)){var oThis=this;if(this.m_oXMLHTTPReqObj.open(cMethod,cURL,!1),this.m_oXMLHTTPReqObj.send(cPostParams),bEvalResponse)if(window.JSON)try{oResponse=window.JSON.parse(this.m_oXMLHTTPReqObj.responseText)}catch(e){eval("oResponse = "+this.m_oXMLHTTPReqObj.responseText)}else eval("oResponse = "+this.m_oXMLHTTPReqObj.responseText)}}catch(e){}return oResponse},InxpoAJAXObject.prototype.Abort=function(){this.m_oXMLHTTPReqObj&&4!=this.m_oXMLHTTPReqObj.readyState&&this.m_oXMLHTTPReqObj.abort()},InxpoAJAXObject.prototype.OnLoading=function(){},InxpoAJAXObject.prototype.OnLoaded=function(){},InxpoAJAXObject.prototype.OnInteractive=function(){},InxpoAJAXObject.prototype.OnComplete=function(cResponse,oInxpoAJAXObject){},InxpoAJAXObject.prototype.OnAbort=function(){},InxpoAJAXObject.prototype.OnFileUploadProgress=function(oEvent){},InxpoAJAXObject.prototype.OnError=function(iStatus,cStatusText){},InxpoAJAXObject.prototype.ReadyStateChange=function(){try{1==this.m_oXMLHTTPReqObj.readyState?this.OnLoading&&this.OnLoading():2==this.m_oXMLHTTPReqObj.readyState?this.OnLoaded&&this.OnLoaded():3==this.m_oXMLHTTPReqObj.readyState?this.OnInteractive&&this.OnInteractive():4==this.m_oXMLHTTPReqObj.readyState&&(0==this.m_oXMLHTTPReqObj.status?this.OnAbort&&this.OnAbort():200==this.m_oXMLHTTPReqObj.status?this.OnComplete&&this.OnComplete(this.m_oXMLHTTPReqObj.responseText,this):this.OnError&&this.OnError(this.m_oXMLHTTPReqObj.status,this.m_oXMLHTTPReqObj.statusText))}catch(e){}};