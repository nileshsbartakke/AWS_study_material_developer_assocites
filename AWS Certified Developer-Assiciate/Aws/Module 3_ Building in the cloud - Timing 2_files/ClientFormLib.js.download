var g_cRequiredImage="url(/cfr/images/EntryRequired.gif)",g_cDecimalSeparator=".",g_cDefaultDateFormat="M/D/Y",g_cTimeFormat="hh:mm tt".replace(" tt","").replace("tt ",""),g_oElemInError=null,g_bUsePasswordPolicy=!1,g_aPasswordPolicy=[0,0,!1,!1,!1,!1,!1],g_aIllegalPasswords=["PASSWORD","PASS","PW","TEST","TESTING","VTS","INXPO","XPOCAST"],g_oStrings={EntryRequired:"{FieldName} may not be blank!\nPlease re-enter.",FileRequired:"Please select a file to upload!",FileExceedsBounds:"Your uploaded file {FileName} must be under {MaxSize} in size.",InvalidEmail:"{FieldName} must be a valid email address!\nPlease re-enter.",InvalidDate:"{FieldName} is an invalid date!\nPlease re-enter in {Format} format.",InvalidTime:"{FieldName} is an invalid time!\nPlease re-enter in {Format} format.",InvalidNumber:"{FieldName} may only contain digits 0-9 and a decimal separator!",NotNegative:"{FieldName} may not be negative!",InvalidInteger:"{FieldName} may only contain digits 0-9!",InvalidURL:"{FieldName} does not appear to be a valid URL!",URLHint:"Please re-enter, beginning with http://, https://, ftp:// or ftps://.",InvalidMinValue:"{FieldName} must be greater than or equal to {Value}.",InvalidMaxValue:"{FieldName} must be less than or equal to {Value}.",InvalidChar:"{FieldName} must not contain characters in the set [].",InvalidMinLength:"{FieldName} must be at least {Number} characters in length.",InvalidMaxLength:"{FieldName} must be no more than {Number} characters in length.",AlphaNumeric:"{FieldName} must contain letters and numbers.",AllNumeric:"{FieldName} must contain a letter or symbol.",SameCharacter:"{FieldName} must contain differing characters.",InvalidWord:"{FieldName} is a word that is not allowed.",ContainsLogin:"{FieldName} cannot contain your Login ID.",InvalidInclusion:"{FieldName} must be in the value set [].",InvalidExclusion:"{FieldName} must not be in the value set [].",InvalidIPAddress:"{FieldName} must be a valid IP address!\nPlease re-enter in {Format} format, (i.e. {example}).",InvalidSymbols:"The password must not contain any of the following symbols...",PasswordRequired:"Password is required",PasswordShort:"Password is too short",PasswordLong:"Password is too long",PasswordAlpha:"Password must contain letters and numbers",PasswordNumeric:"Password must contain a letter or symbol",PasswordSameChar:"Password must contain differing characters",PasswordNotAllowed:"That password is not allowed",PasswordContainsLogin:"Password cannot contain your Login ID",PasswordValid:"Password is acceptable",Required:"required"},g_oPasswordElemHold=null,g_bSuppressValidationAlert=!1,g_bUseErrorObjects=!1,g_bUseErrorModal=!1,g_cLastValidationError="",g_oErrorObjects={};function InputField_OnBlur(aEvent){var oElem=new EventObj(aEvent).srcElement,cInputType=oElem.getAttribute("InputType");null!=cInputType&&cInputType.indexOf("R")>-1&&oElem.value.length<1&&-1==["checkbox","radio"].indexOf(oElem.type)&&"SELECT"!=oElem.tagName&&(oElem.style.backgroundImage=g_cRequiredImage,oElem.style.backgroundRepeat="no-repeat")}function InputField_OnChange(aEvent){var oElem=new EventObj(aEvent).srcElement,cInputType=oElem.getAttribute("InputType");null!=cInputType&&"text"==oElem.type&&oElem.value.length>0&&(cInputType.indexOf("U")>-1?oElem.value=oElem.value.toUpperCase():cInputType.indexOf("L")>-1&&(oElem.value=oElem.value.toLowerCase()))}function InputField_OnFocus(aEvent){var oElem=new EventObj(aEvent).srcElement,cInputType=oElem.getAttribute("InputType");null!=cInputType&&cInputType.indexOf("R")>-1&&(oElem.style.backgroundImage="")}function InputForm_Submit(aEvent,oEvent){null==oEvent&&(oEvent=new EventObj(aEvent)),oEvent.ReturnValue(!0),InputForm_Validate(oEvent.srcElement,oEvent)||oEvent.ReturnValue(!1)}function InputForm_Validate(oForm,oEvent){g_bUseErrorObjects&&ClearErrorObjects();var iCount=oForm.length,bRetval=!0;g_oElemInError=null;for(var iLup=0;iLup<iCount&&((bRetval=ValidateInputField(oForm.elements[iLup],oEvent))||g_bSuppressValidationAlert||g_bUseErrorObjects);iLup++);return bRetval}function ValidateInputField(oElem,oEvent){var cInputType,bValid=!0,bFound=!1;if("text"!=oElem.type&&"file"!=oElem.type&&"select"!=oElem.type&&"select-one"!=oElem.type&&"select-multiple"!=oElem.type&&"password"!=oElem.type&&"textarea"!=oElem.type)return!0;if(oElem.readOnly||oElem.disabled)return!0;if(null!=(cInputType=oElem.getAttribute("InputType"))){if(cInputType.indexOf("R")>-1&&oElem.value.length<1)return"file"==oElem.type?DoValidationError(oEvent,oElem,g_oStrings.FileRequired):DoValidationError(oEvent,oElem,g_oStrings.EntryRequired),!1;if("select"==oElem.type||"select-one"==oElem.type||"select-multiple"==oElem.type)return!0;if("file"==oElem.type&&""!=oElem.value&&ValidateUploadFileSize&&cInputType.indexOf("FileSize")>-1){var cMinBytes=oElem.getAttribute("MinBytes"),iMinBytes=null!=cMinBytes&&""!=cMinBytes?1*cMinBytes:void 0,cMaxBytes=oElem.getAttribute("MaxBytes"),oReturnedLimits={};if(!ValidateUploadFileSize(oElem,oReturnedLimits,iMinBytes,null!=cMaxBytes&&""!=cMaxBytes?1*cMaxBytes:void 0))return DoValidationError(oEvent,oElem,g_oStrings.FileExceedsBounds.replace("{FileSize}",oReturnedLimits.FileSize).replace("{MaxSize}",FormatFileSize(oReturnedLimits.MaxBytes)).replace("{MinSize}",FormatFileSize(oReturnedLimits.MinBytes)).replace("{FileName}",oReturnedLimits.FileName)),!1}if(cInputType.indexOf("E")>-1&&""!=oElem.value){if(oElem.value.indexOf(" ")>-1)bValid=!1;else{!/(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)/.test(oElem.value)&&/^(?!\.)((?!.*\.{2})[a-zA-Z0-9\u0080-\u02AF\u0300-\u07FF\u0900-\u18AF\u1900-\u1A1F\u1B00-\u1B7F\u1D00-\u1FFF\u20D0-\u214F\u2C00-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u319F\u31C0-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF\.!#$%&'*+-/=?^_`{|}~\-\d]+)@(?!\.)([a-zA-Z0-9\u0080-\u02AF\u0300-\u07FF\u0900-\u18AF\u1900-\u1A1F\u1B00-\u1B7F\u1D00-\u1FFF\u20D0-\u214F\u2C00-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u319F\u31C0-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF\-\.\d]+)((\.([a-zA-Z\u0080-\u02AF\u0300-\u07FF\u0900-\u18AF\u1900-\u1A1F\u1B00-\u1B7F\u1D00-\u1FFF\u20D0-\u214F\u2C00-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u319F\u31C0-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF]){2,63})+)$/i.test(oElem.value)||(bValid=!1),bValid&&oElem.value.indexOf(",")>-1&&(bValid=!1)}if(!bValid)return DoValidationError(oEvent,oElem,g_oStrings.InvalidEmail),!1}if(cInputType.indexOf("ipv")>-1&&""!=oElem.value){if(cInputType.indexOf("ipv4")>-1&&!IsValidIPv4(oElem.value))return DoValidationError(oEvent,oElem,g_oStrings.InvalidIPAddress.replace("{Format}","IPv4").replace("{example}","192.168.1.1")),!1;if(cInputType.indexOf("ipv6")>-1&&!IsValidIPv6(oElem.value))return DoValidationError(oEvent,oElem,g_oStrings.InvalidIPAddress.replace("{Format}","IPv6").replace("{example}","FE80:0000:0000:0000:0202:B3FF:FE1E:8329")),!1;if(cInputType.indexOf("ipvx")>-1&&!IsValidIPv4(oElem.value)&&!IsValidIPv6(oElem.value))return DoValidationError(oEvent,oElem,g_oStrings.InvalidIPAddress.replace("{Format}","IPv4 or IPv6").replace("{example}","192.168.1.1 or FE80:0000:0000:0000:0202:B3FF:FE1E:8329")),!1}if(cInputType.indexOf("D")>-1&&""!=oElem.value){var cDateFmt=g_cDateFmtMask;if(null==cDateFmt&&(cDateFmt=g_cDefaultDateFormat),oElem.defaultValue=oElem.value,!IsValidDate(oElem,cDateFmt))return DoValidationError(oEvent,oElem,g_oStrings.InvalidDate.replace("{Format}",cDateFmt)),!1}if(cInputType.indexOf("T")>-1&&""!=oElem.value&&!IsValidTime(oElem))return DoValidationError(oEvent,oElem,g_oStrings.InvalidTime.replace("{Format}",g_cTimeFormat)),!1;if(cInputType.indexOf("N")>-1&&""!=oElem.value){for(var cChar="",iIndex=0;iIndex<oElem.value.length;iIndex++)if(cChar=oElem.value.charAt(iIndex),(0==iIndex?"-.0123456789".indexOf(cChar):".0123456789".indexOf(cChar))<0){DoValidationError(oEvent,oElem,g_oStrings.InvalidNumber),bValid=!1;break}if(!bValid)return!1;if("."==oElem.value&&(oElem.value="0.0"),cInputType.indexOf("+")>-1&&1*oElem.value<0)return DoValidationError(oEvent,oElem,g_oStrings.NotNegative),!1}if(cInputType.indexOf("I")>-1&&""!=oElem.value){for(cChar="",iIndex=0;iIndex<oElem.value.length;iIndex++)if(cChar=oElem.value.charAt(iIndex),(0==iIndex?"-0123456789".indexOf(cChar):"0123456789".indexOf(cChar))<0){DoValidationError(oEvent,oElem,g_oStrings.InvalidInteger),bValid=!1;break}if(!bValid)return!1;if(cInputType.indexOf("+")>-1&&1*oElem.value<0)return DoValidationError(oEvent,oElem,g_oStrings.NotNegative),!1}if(cInputType.indexOf("H")>-1&&""!=oElem.value){var cProto=oElem.value.substr(0,8).toLowerCase();if("http://"!=cProto.substr(0,7)&&"https://"!=cProto&&"ftp://"!=cProto.substr(0,6)&&"ftps://"!=cProto.substr(0,7)&&"server.nxp"!=oElem.value.substr(0,10).toLowerCase()&&"mms://"!=cProto.substr(0,6)&&"/"!=cProto.substr(0,1))return DoValidationError(oEvent,oElem,g_oStrings.InvalidURL+"\n"+g_oStrings.URLHint),!1}cInputType.indexOf("U")>-1&&(oElem.value=oElem.value.toUpperCase()),cInputType.indexOf("L")>-1&&(oElem.value=oElem.value.toLowerCase());var cMinValue=oElem.getAttribute("MinValue");if(null!=cMinValue&&""!=cMinValue&&""!=oElem.value){if(cInputType.indexOf("I")>-1||cInputType.indexOf("N")>-1)1*oElem.value<1*cMinValue&&(bValid=!1);else if(cInputType.indexOf("D")>-1){var oMinDate=new Date(Date.parse(cMinValue));new Date(Date.parse(oElem.value))<oMinDate&&(bValid=!1)}else oElem.value<cMinValue&&(bValid=!1);if(!bValid)return DoValidationError(oEvent,oElem,g_oStrings.InvalidMinValue.replace("{Value}",cMinValue)),!1}var cMaxValue=oElem.getAttribute("MaxValue");if(null!=cMaxValue&&""!=cMaxValue&&""!=oElem.value){if(cInputType.indexOf("I")>-1||cInputType.indexOf("N")>-1)1*oElem.value>1*cMaxValue&&(bValid=!1);else if(cInputType.indexOf("D")>-1){var oMaxDate=new Date(Date.parse(cMaxValue));new Date(Date.parse(oElem.value))>oMaxDate&&(bValid=!1)}else oElem.value>cMaxValue&&(bValid=!1);if(!bValid)return DoValidationError(oEvent,oElem,g_oStrings.InvalidMaxValue.replace("{Value}",cMaxValue)),!1}if(cInputType.indexOf("X")>-1){var cExcludeChars=oElem.getAttribute("ExcludeChars");if(cExcludeChars&&""!=cExcludeChars)for(var i=0;i<cExcludeChars.length;i++)if(oElem.value.indexOf(cExcludeChars.substr(i,1))>-1){bFound=!0;break}if(bFound)return DoValidationError(oEvent,oElem,g_oStrings.InvalidChar.replace("[]","["+cExcludeChars+"]")),!1}if(cInputType.indexOf("P")>-1&&oElem.value.length>0){if(g_aPasswordPolicy[0]&&oElem.value.length<g_aPasswordPolicy[0])return DoValidationError(oEvent,oElem,g_oStrings.InvalidMinLength.replace("{Number}",g_aPasswordPolicy[0])),!1;if(g_aPasswordPolicy[1]&&oElem.value.length>g_aPasswordPolicy[1])return DoValidationError(oEvent,oElem,g_oStrings.InvalidMaxLength.replace("{Number}",g_aPasswordPolicy[1])),!1;if(g_aPasswordPolicy[2])if(!/^[ A-Za-z0-9\!\@\_\-\.]*?([A-Za-z][ A-Za-z0-9\!\@\_\-\.]*?[0-9]|[0-9][ A-Za-z0-9\!\@\_\-\.]*?[A-Za-z])[ A-Za-z0-9\!\@\_\-\.]*$/.test(oElem.value))return DoValidationError(oEvent,oElem,g_oStrings.AlphaNumeric),!1;if(g_aPasswordPolicy[3])if(!/^[ A-Za-z0-9\!\@\_\-\.]*?[ a-zA-Z\!\@\_\-\.]+[ A-Za-z0-9\!\@\_\-\.]*$/.test(oElem.value))return DoValidationError(oEvent,oElem,g_oStrings.AllNumeric),!1;if(g_aPasswordPolicy[4]){iIndex=0;var bSame=!0;cChar=oElem.value.toUpperCase().substr(0,1);do{cChar!=oElem.value.toUpperCase().substr(iIndex,1)&&(bSame=!1),iIndex++}while(bSame&&iIndex<oElem.value.length);if(bSame)return DoValidationError(oEvent,oElem,g_oStrings.SameCharacter),!1}if(g_aPasswordPolicy[5]&&g_aIllegalPasswords.indexOf(oElem.value.toUpperCase())>-1)return DoValidationError(oEvent,oElem,g_oStrings.InvalidWord),!1;if(g_aPasswordPolicy[6]){var cUserID=null;if(document.forms[0]&&document.forms[0].elements.LoginID&&(cUserID=document.forms[0].elements.LoginID.value),g_aPasswordPolicy[6]&&cUserID&&oElem.value.toUpperCase().indexOf(cUserID.toUpperCase())>-1)return DoValidationError(oEvent,oElem,g_oStrings.ContainsLogin),!1}}if(null!=oElem.getAttribute("InclusionSet")&&""!=oElem.value){var aInclusionSet=oElem.getAttribute("InclusionSet");for(iIndex=0;iIndex<aInclusionSet.length&&(xValue=aInclusionSet[iIndex],cInputType.indexOf("I")>-1||cInputType.indexOf("N")>-1?1*oElem.value==xValue&&(bFound=!0):oElem.value==xValue&&(bFound=!0),!bFound);iIndex++);if(!bFound)return DoValidationError(oEvent,oElem,g_oStrings.InvalidInclusion.replace("[]","["+aInclusionSet.toString()+"]")),!1}if(null!=oElem.getAttribute("ExclusionSet")&&""!=oElem.value){bFound=!1;var xValue,aExclusionSet=oElem.getAttribute("ExclusionSet");for(iIndex=0;iIndex<aExclusionSet.length&&(xValue=aExclusionSet[iIndex],cInputType.indexOf("I")>-1||cInputType.indexOf("N")>-1?1*oElem.value==xValue&&(bFound=!0):oElem.value==xValue&&(bFound=!0),!bFound);iIndex++);if(bFound)return DoValidationError(oEvent,oElem,g_oStrings.InvalidExclusion.replace("[]","["+aExclusionSet.toString()+"]")),!1}if("TEXTAREA"==oElem.tagName&&oElem.getAttribute("maxlength")){var iLen=parseInt(oElem.getAttribute("maxlength"));if(oElem.value.length>iLen)return DoValidationError(oEvent,oElem,g_oStrings.InvalidMaxLength.replace("{Number}",iLen)),!1}}return!0}function IsValidTime(oElem){var iHour,iMinute,iPos=oElem.value.indexOf(":");return!(iPos<0)&&(iHour=1*oElem.value.substr(0,iPos),iMinute=1*oElem.value.substr(iPos+1),!(iHour<0||iHour>23)&&!(iMinute<0||iMinute>59))}function IsValidIPv4(cIPAddress){return/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(cIPAddress)}function IsValidIPv6(cIPAddress){return/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/.test(cIPAddress)}function IsLeapYear(iYear){return!(iYear%4!=0||iYear%100==0&&iYear%400!=0)}function IsValidDate(oElem,cDateFmt){var iPos,iPos2,cDelimiter,iMonth=0,iDay=0,iYear=0;if((iPos=oElem.value.indexOf("/"))<0)if((iPos=oElem.value.indexOf("-"))<0){if((iPos=oElem.value.indexOf("."))<0)return!1;cDelimiter="."}else cDelimiter="-";else cDelimiter="/";if(oElem.value.split(cDelimiter).length>3)return!1;switch(iPos2=oElem.value.indexOf(cDelimiter,iPos+1),cDateFmt.substr(0,1)){case"M":iMonth=1*oElem.value.substr(0,iPos);break;case"D":iDay=1*oElem.value.substr(0,iPos);break;case"Y":iYear=1*oElem.value.substr(0,iPos)}switch(cDateFmt.substr(2,1)){case"M":iMonth=1*oElem.value.substr(iPos+1,iPos2-iPos-1);break;case"D":iDay=1*oElem.value.substr(iPos+1,iPos2-iPos-1);break;case"Y":iYear=1*oElem.value.substr(iPos+1,iPos2-iPos-1)}switch(cDateFmt.substr(4,1)){case"M":iMonth=1*oElem.value.substr(iPos2+1);break;case"D":iDay=1*oElem.value.substr(iPos2+1);break;case"Y":iYear=1*oElem.value.substr(iPos2+1)}if(iMonth<1||iMonth>12)return!1;if(iDay<1)return!1;if(4==iMonth||6==iMonth||9==iMonth||11==iMonth){if(iDay>30)return!1}else if(2==iMonth&&iDay>28){if(!IsLeapYear(iYear))return!1;if(iDay>29)return!1}else if(iDay>31)return!1;return iYear<1900&&(iYear+=iYear<50?2e3:1900),!(iYear>2199)&&(oElem.value=MDYToDate101(iMonth,iDay,iYear),!0)}function MDYToDate101(iMonth,iDay,iYear){var cRetval,cPart;return cRetval=(cPart=(cPart="0"+iMonth).substr(cPart.length-2,2))+"/",cRetval+=(cPart=(cPart="0"+iDay).substr(cPart.length-2,2))+"/"+iYear}function Date101ToLocalDate(cDate101){var iPos,iPos2,cDelimiter;if((iPos=cDate101.indexOf("/"))<0)if((iPos=cDate101.indexOf("-"))<0){if((iPos=cDate101.indexOf("."))<0)return"";cDelimiter="."}else cDelimiter="-";else cDelimiter="/";return iPos2=cDate101.indexOf(cDelimiter,iPos+1),MDYToLocalDate(1*cDate101.substr(0,iPos),1*cDate101.substr(iPos+1,iPos2-iPos-1),1*cDate101.substr(iPos2+1))}function MDYToLocalDate(iMonth,iDay,iYear){for(var cPart,cRetval="",cDelimiter=g_cDateFmtMask.substr(1,1),iLup=0;iLup<5;iLup+=2){switch(g_cDateFmtMask.substr(iLup,1)){case"M":cPart=(cPart="0"+iMonth).substr(cPart.length-2,2);break;case"D":cPart=(cPart="0"+iDay).substr(cPart.length-2,2);break;case"Y":cPart=""+iYear}cRetval+=cPart,iLup<4&&(cRetval+=cDelimiter)}return cRetval}function LocalDateToDate101(cLocalDate){var iPos,iPos2,cDelimiter,iMonth=0,iDay=0,iYear=0;if((iPos=cLocalDate.indexOf("/"))<0)if((iPos=cLocalDate.indexOf("-"))<0){if((iPos=cLocalDate.indexOf("."))<0)return"";cDelimiter="."}else cDelimiter="-";else cDelimiter="/";switch(iPos2=cLocalDate.indexOf(cDelimiter,iPos+1),g_cDateFmtMask.substr(0,1)){case"M":iMonth=1*cLocalDate.substr(0,iPos);break;case"D":iDay=1*cLocalDate.substr(0,iPos);break;case"Y":iYear=1*cLocalDate.substr(0,iPos)}switch(g_cDateFmtMask.substr(2,1)){case"M":iMonth=1*cLocalDate.substr(iPos+1,iPos2-iPos-1);break;case"D":iDay=1*cLocalDate.substr(iPos+1,iPos2-iPos-1);break;case"Y":iYear=1*cLocalDate.substr(iPos+1,iPos2-iPos-1)}switch(g_cDateFmtMask.substr(4,1)){case"M":iMonth=1*cLocalDate.substr(iPos2+1);break;case"D":iDay=1*cLocalDate.substr(iPos2+1);break;case"Y":iYear=1*cLocalDate.substr(iPos2+1)}return MDYToDate101(iMonth,iDay,iYear)}function DoValidationError(oEvent,oElem,cErrorText){oEvent&&oEvent.ReturnValue&&oEvent.ReturnValue(!1);var cError=cErrorText;if(oElem){RestoreDateFields(oElem);var cTitle=GetTitle(oElem);cError=cErrorText.replace("{FieldName}",cTitle)}if(g_bSuppressValidationAlert||g_bUseErrorObjects)g_cLastValidationError=cError,g_bUseErrorObjects&&GenerateErrorObj(oElem);else if(alert(cError),oElem){g_oElemInError=oElem;try{oElem.focus()}catch(e){}}}var g_oCFLib_FileGuide=[{Denominator:Math.pow(2,0),Unit:"B"},{Denominator:Math.pow(2,10),Unit:"KB"},{Denominator:Math.pow(2,20),Unit:"MB"},{Denominator:Math.pow(2,30),Unit:"GB"},{Denominator:Math.pow(2,40),Unit:"TB"},{Denominator:Math.pow(2,50),Unit:"PB"}];function FormatFileSize(iSize){if(iSize<=0)return"0 B";var iMag=Math.max(Math.min(Math.floor(Math.log(iSize)/6.931471805599453),g_oCFLib_FileGuide.length-1),0);return.1*Math.round(iSize/g_oCFLib_FileGuide[iMag].Denominator*10)+" "+g_oCFLib_FileGuide[iMag].Unit}function RestoreDateFields(oErrElem){var oForm=oErrElem.form;if(oForm)for(var oElem,iCount=oForm.length,iLup=0;iLup<iCount&&(oElem=oForm.elements[iLup])!=oErrElem;iLup++)"text"==oElem.type&&(oElem.readOnly||oElem.disabled||null!=oElem.getAttribute("InputType")&&oElem.getAttribute("InputType").indexOf("D")>-1&&oElem.defaultValue.length>0&&(oElem.value=oElem.defaultValue))}function RestoreAllDateFields(oForm){for(var oElem,iCount=oForm.length,iLup=0;iLup<iCount;iLup++)"text"==(oElem=oForm.elements[iLup]).type&&(oElem.readOnly||oElem.disabled||null!=oElem.getAttribute("InputType")&&oElem.getAttribute("InputType").indexOf("D")>-1&&oElem.defaultValue.length>0&&(oElem.value=oElem.defaultValue))}function IsNavKey(iKeyCode){switch(iKeyCode){case 8:case 9:case 13:return!0;default:return!1}}function InputField_OnKeyPressNumbersOnly(aEvent){var oEvent=new EventObj(aEvent);"INPUT"!=oEvent.srcElement.tagName||oEvent.ctrlKey||(oEvent.keyCode<48||oEvent.keyCode>57)&&(45==oEvent.keyCode&&null!=oEvent.srcElement.getAttribute("InputType")?(oEvent.srcElement.getAttribute("InputType").indexOf("+")>-1||oEvent.srcElement.value.indexOf("-")>-1)&&(oEvent.ReturnValue(!1),oEvent.CancelBubble(!0)):46==oEvent.keyCode&&null!=oEvent.srcElement.getAttribute("InputType")&&oEvent.srcElement.getAttribute("InputType").indexOf("N")>-1?oEvent.srcElement.value.indexOf(g_cDecimalSeparator)>-1&&(oEvent.ReturnValue(!1),oEvent.CancelBubble(!0)):IsNavKey(oEvent.keyCode)||(oEvent.ReturnValue(!1),oEvent.CancelBubble(!0)))}function InputField_OnKeyPressDateValuesOnly(aEvent){var oEvent=new EventObj(aEvent);"INPUT"!=oEvent.srcElement.tagName||oEvent.ctrlKey||(oEvent.keyCode<45||oEvent.keyCode>57)&&!IsNavKey(oEvent.keyCode)&&(oEvent.ReturnValue(!1),oEvent.CancelBubble(!0))}function InputField_OnPasteNumbersOnly(aEvent){var oEvent=new EventObj(aEvent),oElem=oEvent.srcElement,cOldValue=oEvent.srcElement.value.toString();setTimeout(HandlePasteInputFieldNumbersOnly,0,oElem,cOldValue)}function HandlePasteInputFieldNumbersOnly(oElem,cOldValue){var cValue=oElem.value;if(cValue&&!(cValue.length<=0)){var iCharCode,cNewString="";if("INPUT"==oElem.tagName){for(;cValue.length>0;){if((iCharCode=cValue.charCodeAt(0))<48||iCharCode>57){if(45==iCharCode&&null!=oElem.getAttribute("InputType")){if(oElem.getAttribute("InputType").indexOf("+")>-1||oElem.value.indexOf("-")>-1){cNewString=cOldValue;break}}else if(46==iCharCode&&null!=oElem.getAttribute("InputType")&&oElem.getAttribute("InputType").indexOf("N")>-1){if(oElem.value.indexOf(g_cDecimalSeparator)>-1){cNewString=cOldValue;break}}else if(!IsNavKey(iCharCode)){cNewString=cOldValue;break}}else cNewString+=cValue.substr(0,1);cValue=cValue.substring(1)}oElem.value=cNewString}}}function InputField_OnKeyPressIPv4Address(aEvent){var iDelimeterCount,cSearch,oEvent=new EventObj(aEvent);if("INPUT"==oEvent.srcElement.tagName&&(oEvent.keyCode<48||oEvent.keyCode>57))if(46==oEvent.keyCode){iDelimeterCount=0,cSearch=oEvent.srcElement.value;for(var iLup=0;iLup<cSearch.length;iLup++)"."==cSearch.substr(iLup,1)&&iDelimeterCount++;iDelimeterCount>=3&&(oEvent.ReturnValue(!1),oEvent.CancelBubble(!0))}else IsNavKey(oEvent.keyCode)||(oEvent.ReturnValue(!1),oEvent.CancelBubble(!0))}function InputField_OnKeyPressExcludeChars(aEvent){var oEvent=new EventObj(aEvent);if(("INPUT"==oEvent.srcElement.tagName||"TEXTAREA"==oEvent.srcElement.tagName)&&!oEvent.ctrlKey){var cChar=void 0==aEvent||void 0==aEvent.charCode?oEvent.keyCode:aEvent.charCode,cExcludeChars=oEvent.srcElement.getAttribute("ExcludeChars");cExcludeChars&&""!=cExcludeChars&&!IsNavKey(cChar)&&cExcludeChars.indexOf(String.fromCharCode(cChar))>-1&&(oEvent.ReturnValue(!1),oEvent.CancelBubble(!0))}}function InputField_OnKeyDownPassword(aEvent){var oEvent=new EventObj(aEvent),iChar=oEvent.keyCode;iChar>=35&&iChar<=46?oEvent.ReturnValue(!0):(g_oPasswordElemHold=oEvent.srcElement,setTimeout("ValidatePassword()"),oEvent.ReturnValue(!0))}function InputField_OnChangeLoginID(aEvent){(g_oPasswordElemHold=document.forms[0].elements.Password)&&setTimeout("ValidatePassword()")}function InputField_OnPastePassword(aEvent){var oEvent=new EventObj(aEvent);g_oPasswordElemHold=oEvent.srcElement,setTimeout("ValidatePassword()")}function ValidatePassword(oPassword){if(oPassword||(oPassword=g_oPasswordElemHold),oPassword){var cPassword=oPassword.value,cInputType=oPassword.getAttribute("InputType");if(null==cInputType||""==cInputType)return!0;if(cInputType.indexOf("R")>-1&&0==cPassword.length)return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordRequired),!0;if(!g_bUsePasswordPolicy)return void ShowPasswordStatus(oPassword,!0,null);if(g_aPasswordPolicy[0]&&cPassword.length<g_aPasswordPolicy[0])return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordShort),!0;if(g_aPasswordPolicy[1]&&cPassword.length>g_aPasswordPolicy[1])return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordLong),!0;if(g_aPasswordPolicy[2])if(!/^[ A-Za-z0-9\!\@\_\-\.]*?([A-Za-z][ A-Za-z0-9\!\@\_\-\.]*?[0-9]|[0-9][ A-Za-z0-9\!\@\_\-\.]*?[A-Za-z])[ A-Za-z0-9\!\@\_\-\.]*$/.test(cPassword))return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordAlpha),!0;if(g_aPasswordPolicy[3])if(!/^[ A-Za-z0-9\!\@\_\-\.]*?[ a-zA-Z\!\@\_\-\.]+[ A-Za-z0-9\!\@\_\-\.]*$/.test(cPassword))return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordNumeric),!0;if(g_aPasswordPolicy[4]){var iIndex=0,bSame=!0,cChar=cPassword.toUpperCase().substr(0,1);do{cChar!=cPassword.toUpperCase().substr(iIndex,1)&&(bSame=!1),iIndex++}while(bSame&&iIndex<cPassword.length);if(bSame)return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordSameChar),!0}if(g_aPasswordPolicy[5]&&g_aIllegalPasswords.indexOf(cPassword.toUpperCase())>-1)return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordNotAllowed),!0;if(g_aPasswordPolicy[6]){var cUserID=null;if(document.forms[0]&&document.forms[0].elements.LoginID&&(cUserID=document.forms[0].elements.LoginID.value),g_aPasswordPolicy[6]&&cUserID&&cPassword.toUpperCase().indexOf(cUserID.toUpperCase())>-1)return ShowPasswordStatus(oPassword,!1,g_oStrings.PasswordContainsLogin),!0}ShowPasswordStatus(oPassword,!0,""),g_oPasswordElemHold=null}return!0}function ShowPasswordStatus(oPasswordElem,bValid,cMsg){var oStatusImg=document.getElementById("PasswordStatusImg"),oStatusText=document.getElementById("PasswordStatusText");oStatusImg&&oStatusText||"ContentBox"==oPasswordElem.className||(CreatePasswordStatus(oPasswordElem),oStatusImg=document.getElementById("PasswordStatusImg"),oStatusText=document.getElementById("PasswordStatusText")),oStatusImg&&oStatusText&&(oStatusImg.src=bValid?"/cfr/Images/VTS/PasswordGood.png":"/cfr/Images/VTS/PasswordBad.png",oStatusImg.title=bValid?g_oStrings.PasswordValid:cMsg,oStatusText.style.color=bValid?"Green":"Red",oStatusText.innerHTML=bValid?g_oStrings.PasswordValid:cMsg)}function CreatePasswordStatus(oPasswordElem){if(oPasswordElem){var oParent=oPasswordElem.parentNode,oStatusImg=document.getElementById("PasswordStatusImg");oStatusImg||((oStatusImg=document.createElement("IMG")).id="PasswordStatusImg",oStatusImg.className="PasswordStatusImage",oParent&&oParent.insertBefore(oStatusImg,oPasswordElem.nextSibling));var oStatusText=document.getElementById("PasswordStatusText");oStatusText||((oStatusText=document.createElement("SPAN")).id="PasswordStatusText",oStatusText.className="PasswordStatus",oParent&&oParent.insertBefore(oStatusText,oStatusImg.nextSibling))}}function SetPasswordPolicy(cPolicy){var aPolicy=[0,0,!1,!1,!1,!1,!1];cPolicy&&""!=cPolicy&&"NULL"!=cPolicy&&(aPolicy=cPolicy.split(",")),g_aPasswordPolicy[0]=1*aPolicy[0]?1*aPolicy[0]:0,g_aPasswordPolicy[1]=1*aPolicy[1]?1*aPolicy[1]:0,g_aPasswordPolicy[2]="1"==aPolicy[2],g_aPasswordPolicy[3]="1"==aPolicy[3],g_aPasswordPolicy[4]="1"==aPolicy[4],g_aPasswordPolicy[5]="1"==aPolicy[5],g_aPasswordPolicy[6]="1"==aPolicy[6],(g_aPasswordPolicy[0]>0||g_aPasswordPolicy[1]>0||g_aPasswordPolicy.indexOf(!0)>-1)&&(g_bUsePasswordPolicy=!0)}function InitForms(bSetFocusToFirstElement){for(var iCount=document.forms.length,iLup=0;iLup<iCount;iLup++)bSetFocusToFirstElement=!InitSingleForm(document.forms[iLup],bSetFocusToFirstElement)&&bSetFocusToFirstElement}function InitSingleForm(oForm,bSetFocusToFirstElement){var oElem,oFirstElement=null,bFocusSet=!1;null==oForm.onsubmit&&(oForm.onsubmit=InputForm_Submit);for(var iFormCount=oForm.length,iIndex=0;iIndex<iFormCount;iIndex++)oElem=oForm.elements[iIndex],null==oFirstElement&&"hidden"!=oElem.type&&!1===oElem.disabled&&"none"!=oElem.style.display&&"hidden"!=oElem.style.display&&(oFirstElement=oElem),null!=oElem.getAttribute("InputType")&&ConfigureInputField(oElem);if(bSetFocusToFirstElement&&null!=oFirstElement)try{oFirstElement.focus(),bFocusSet=!0}catch(e){}return bFocusSet}function ConfigureInputField(oElem){if(null!=oElem&&null!=oElem.getAttribute("InputType")){var cArialLabel=GetTitle(oElem),cInputType=oElem.getAttribute("InputType");if(cInputType.indexOf("R")>-1&&-1=="checkbox,radio".indexOf(oElem.type)&&"SELECT"!=oElem.tagName&&(""==oElem.style.backgroundImage&&""==oElem.value&&(oElem.style.backgroundImage=g_cRequiredImage,oElem.style.backgroundRepeat="no-repeat"),cArialLabel+=" "+g_oStrings.Required),oElem.setAttribute("aria-label",cArialLabel),oElem.form&&(oElem.form.setAttribute("aria-live","assertive"),oElem.form.setAttribute("aria-relevant","additions"),oElem.form.setAttribute("role","alert")),null==oElem.onfocus&&(oElem.onfocus=InputField_OnFocus),null==oElem.onblur&&(oElem.onblur=InputField_OnBlur),null==oElem.onchange&&(oElem.onchange=InputField_OnChange),(cInputType.indexOf("N")>-1||cInputType.indexOf("I")>-1)&&(null==oElem.onkeypress&&(oElem.onkeypress=InputField_OnKeyPressNumbersOnly),null==oElem.onpaste&&(oElem.onpaste=InputField_OnPasteNumbersOnly)),cInputType.indexOf("D")>-1&&null==oElem.onkeypress&&(oElem.onkeypress=InputField_OnKeyPressDateValuesOnly),cInputType.indexOf("X")>-1&&null!=oElem.getAttribute("ExcludeChars")&&""!=oElem.getAttribute("ExcludeChars")&&null==oElem.onkeypress&&(oElem.onkeypress=InputField_OnKeyPressExcludeChars),cInputType.indexOf("P")>-1&&null==oElem.onkeypress){oElem.onkeydown=InputField_OnKeyDownPassword,oElem.onpaste=InputField_OnPastePassword,cInputType.indexOf("R")>-1&&(g_oPasswordElemHold=oElem,setTimeout("ValidatePassword()"));var oLoginID=document.forms[0].elements.LoginID;oLoginID&&(oLoginID.onchange=InputField_OnChangeLoginID)}if(cInputType.indexOf("ipv4")>-1&&null==oElem.onkeypress&&(oElem.onkeypress=InputField_OnKeyPressIPv4Address),null!=oElem.getAttribute("InclusionSet")){for(var cIncSet=oElem.getAttribute("InclusionSet"),aInclusionSet=new Array,iArrElem=0,iPos=cIncSet.indexOf(";");iPos>0;)cItem=cIncSet.substr(0,iPos),cInputType.indexOf("N")>-1||cInputType.indexOf("I")>-1?aInclusionSet[iArrElem++]=1*cItem:aInclusionSet[iArrElem++]=cItem,iPos=(cIncSet=cIncSet.substr(iPos+1)).indexOf(";");cIncSet.length>0&&(cInputType.indexOf("N")>-1||cInputType.indexOf("I")>-1?aInclusionSet[iArrElem++]=1*cIncSet:aInclusionSet[iArrElem++]=cIncSet),oElem.setAttribute("InclusionSet",aInclusionSet)}if(null!=oElem.getAttribute("ExclusionSet")){var cItem,cExSet=oElem.getAttribute("ExclusionSet"),aExclusionSet=new Array;for(iArrElem=0,iPos=cExSet.indexOf(";");iPos>0;)cItem=cExSet.substr(0,iPos),cInputType.indexOf("N")>-1||cInputType.indexOf("I")>-1?aExclusionSet[iArrElem++]=1*cItem:aExclusionSet[iArrElem++]=cItem,iPos=(cExSet=cExSet.substr(iPos+1)).indexOf(";");cExSet.length>0&&(cInputType.indexOf("N")>-1||cInputType.indexOf("I")>-1?aExclusionSet[iArrElem++]=1*cExSet:aExclusionSet[iArrElem++]=cExSet),oElem.setAttribute("ExclusionSet",aExclusionSet)}}}function LockForm(oForm){var iLup,aElt=oForm.elements;for(iLup=0;iLup<aElt.length;iLup++)LockSpecificElement(aElt[iLup])}function UnlockForm(oForm){var iLup,aElt=oForm.elements;for(iLup=0;iLup<aElt.length;iLup++)UnlockSpecificElement(aElt[iLup])}function LockTag(cKey){var iLup,aElt;if(null!=(aElt=document.getElementsByTagName(cKey)))for(iLup=0;iLup<aElt.length;iLup++)LockSpecificElement(aElt[iLup])}function UnlockTag(cKey){var iLup,aElt;if(null!=(aElt=document.getElementsByTagName(cKey)))for(iLup=0;iLup<aElt.length;iLup++)UnlockSpecificElement(aElt[iLup])}function LockElement(cKey){var oElt,iLup,aElt;if(null!=(oElt=document.getElementById(cKey))&&LockSpecificElement(oElt),null!=(aElt=document.getElementsByName(cKey)))for(iLup=0;iLup<aElt.length;iLup++)LockSpecificElement(aElt[iLup])}function LockSpecificElement(oElt){var readonly=0;if(""==oElt.style.display)if("A"!=oElt.tagName.toUpperCase()){if("INPUT"==oElt.tagName.toUpperCase()){if("HIDDEN"==oElt.type.toUpperCase())return;"TEXT"==oElt.type.toUpperCase()&&(readonly=1)}"TEXTAREA"==oElt.tagName&&(readonly=1),readonly?oElt.readOnly=!0:oElt.disabled=!0}else oElt.href="#"}function UnlockElement(cKey){var oElt,iLup,aElt;if(null!=(oElt=document.getElementById(cKey))&&UnlockSpecificElement(oElt),null!=(aElt=document.getElementsByName(cKey)))for(iLup=0;iLup<aElt.length;iLup++)UnlockSpecificElement(aElt[iLup])}function UnlockSpecificElement(oElt){var readonly=0;if("A"!=oElt.tagName.toUpperCase()&&""==oElt.style.display){if("INPUT"==oElt.tagName.toUpperCase()){if("HIDDEN"==oElt.type.toUpperCase())return;"TEXT"==oElt.type.toUpperCase()&&(readonly=1)}"TEXTAREA"==oElt.tagName&&(readonly=1),readonly?oElt.readOnly=!1:oElt.disabled=!1}}function ValidateFromTo(cMask,cFromDate,iFromH,iFromM,iFromAMPM,cToDate,iToH,iToM,iToAMPM){if(""==cFromDate||""==cToDate)return!0;var dFromDate=LocalDateToUTC(cMask,cFromDate,iFromH,iFromM,iFromAMPM),dToDate=LocalDateToUTC(cMask,cToDate,iToH,iToM,iToAMPM);return null==iFromH?dFromDate<=dToDate:dFromDate<dToDate}function LocalDateToUTC(cMask,cDate,iH,iM,iAMPM){var iYear=null,iMonth=null,iDay=null,aMask=(cMask=cMask?cMask.toUpperCase():"MDY").split(/[\/\.\-]/),aDate=cDate.split(/[\/\.\-]/);if(aMask.length!=aDate.length||aMask.length<2)return null;for(var iLup=0;iLup<aMask.length;iLup++)"Y"!=aMask[iLup]||isNaN(aDate[iLup])||(iYear=1*aDate[iLup]),"M"!=aMask[iLup]||isNaN(aDate[iLup])||(iMonth=1*aDate[iLup]-1),"D"!=aMask[iLup]||isNaN(aDate[iLup])||(iDay=1*aDate[iLup]);if(!iYear||null==iMonth||!iDay)return null;iH=isNaN(iH)?0:1*iH,iM=isNaN(iM)?0:1*iM,null!=iAMPM&&(iH=HourAMPMTo24(iH,iAMPM=isNaN(iAMPM)?0:1*iAMPM));try{return new Date(iYear,iMonth,iDay,iH,iM,0,0)}catch(e){return null}}function HourAMPMTo24(iH,iAMPM){return 12==iH&&0==iAMPM?0:12==iH&&1==iAMPM?12:iH+12*iAMPM}function ValidateFileObjectSize(oEvent,oFile,iMinBytes,iMaxBytes){var oLimits=GetFileSizeLimits(iMaxBytes,iMinBytes),bValid=oFile.size>=oLimits.MinBytes&&oFile.size<=oLimits.MaxBytes;bValid||DoValidationError(oEvent,void 0,g_oStrings.FileExceedsBounds.replace("{FileSize}",oFile.size).replace("{MaxSize}",FormatFileSize(oLimits.MaxBytes)).replace("{MinSize}",FormatFileSize(oLimits.MinBytes)).replace("{FileName}",File.name));return bValid}function GetTitle(oElem){if(!oElem)return"";var cTitle=oElem.getAttribute("FieldName");return cTitle&&0!=cTitle.length||(cTitle=oElem.title.length>0?oElem.title:oElem.name),cTitle||(cTitle=""),0==cTitle.length&&oElem.id&&(cTitle=oElem.id),cTitle=StripHTML(cTitle)}function ClearErrorObjects(){for(var cElem in g_oErrorObjects)ClearSingleErrorObj(cElem)}function ClearSingleErrorObj(cName){try{var oElemObj=g_oErrorObjects[cName];if(oElemObj){try{RemoveClass(oElemObj.Input,"ValidationError"),oElemObj.ErrorMsg.parentNode.removeChild(oElemObj.ErrorMsg)}catch(e){}delete g_oErrorObjects[cName]}}catch(e){}}function GenerateErrorObj(oElem){if(oElem){var oErrorObj={},cTitle=GetTitle(oElem);AddClass(oElem,"ValidationError"),oErrorObj.Input=oElem;var oErrorMsg=document.createElement("p");oErrorMsg.className="ValidationErrorMsg",oErrorMsg.appendChild(document.createTextNode(g_cLastValidationError)),oErrorObj.ErrorMsg=oErrorMsg,oElem.nextSiblingElement?oElem.parentNode.insertBefore(oErrorMsg,oElem.nextSiblingElement):oElem.parentNode.appendChild(oErrorMsg),g_oErrorObjects[cTitle]&&ClearSingleErrorObj(cTitle),g_oErrorObjects[cTitle]=oErrorObj}}